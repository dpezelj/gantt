{"version":3,"file":"index.modern.js","sources":["../src/types/public-types.ts","../src/helpers/date-helper.ts","../src/components/task-list/task-list-header.tsx","../src/components/task-list/useProvideChipColors.ts","../src/components/task-list/task-list-table.tsx","../src/components/other/vertical-scroll.tsx","../src/components/task-list/task-list.tsx","../src/components/grid/grid-body.tsx","../src/components/grid/grid.tsx","../src/components/calendar/top-part-of-calendar.tsx","../src/components/calendar/calendar.tsx","../node_modules/babel-plugin-transform-async-to-promises/helpers.mjs","../src/components/other/arrow.tsx","../src/components/other/relation-line.tsx","../src/helpers/get-relation-circle-by-coordinates.ts","../src/helpers/bar-helper.ts","../src/helpers/other-helper.ts","../node_modules/classnames/index.js","../src/components/task-item/bar/bar-display.tsx","../src/components/task-item/bar/bar-date-handle.tsx","../src/components/task-item/bar/bar-relation-handle.tsx","../src/components/task-item/bar/bar-progress-handle.tsx","../src/components/task-item/bar/bar.tsx","../src/components/task-item/milestone/milestone.tsx","../src/components/task-item/project/project.tsx","../src/components/task-item/task-item.tsx","../src/components/gantt/task-gantt-content.tsx","../src/components/gantt/task-gantt.tsx","../src/components/gantt/gantt.tsx"],"sourcesContent":["import { BarTask } from \"./bar-task\";\r\nimport { RelationMoveTarget } from \"./gantt-task-actions\";\r\n\r\nexport enum ViewMode {\r\n  Hour = \"Hour\",\r\n  QuarterDay = \"Quarter Day\",\r\n  HalfDay = \"Half Day\",\r\n  Day = \"Day\",\r\n  /** ISO-8601 week */\r\n  Week = \"Week\",\r\n  Month = \"Month\",\r\n  Year = \"Year\",\r\n}\r\n\r\nexport type OnRelationChange = (\r\n  from: [Task, RelationMoveTarget],\r\n  to: [Task, RelationMoveTarget]\r\n) => void;\r\n\r\nexport type TaskType = \"task\" | \"milestone\" | \"project\";\r\nexport interface Task {\r\n  id: string;\r\n  type: TaskType;\r\n  name: string;\r\n  start: Date;\r\n  end: Date;\r\n  prevStart?: Date;\r\n  prevEnd?: Date;\r\n  /**\r\n   * From 0 to 100\r\n   */\r\n  progress: number;\r\n  styles?: {\r\n    backgroundColor?: string;\r\n    backgroundSelectedColor?: string;\r\n    progressColor?: string;\r\n    progressSelectedColor?: string;\r\n  };\r\n  isDisabled?: boolean;\r\n  project?: string;\r\n  dependencies?: string[];\r\n  hideChildren?: boolean;\r\n  displayOrder?: number;\r\n  color?: string;\r\n}\r\n\r\nexport interface EventOption {\r\n  /**\r\n   * Time step value for date changes.\r\n   */\r\n  timeStep?: number;\r\n  /**\r\n   * Invokes on bar select on unselect.\r\n   */\r\n  onSelect?: (task: Task, isSelected: boolean) => void;\r\n  /**\r\n   * Invokes on bar double click.\r\n   */\r\n  onDoubleClick?: (task: Task) => void;\r\n  /**\r\n   * Invokes on bar click.\r\n   */\r\n  onClick?: (task: Task) => void;\r\n  /**\r\n   * Invokes on end and start time change. Chart undoes operation if method return false or error.\r\n   */\r\n  onDateChange?: (\r\n    task: Task,\r\n    children: BarTask[],\r\n    changedTasks: BarTask[]\r\n  ) => void | boolean | Promise<void> | Promise<boolean>;\r\n\r\n  /**\r\n   * Invokes new relation between tasks\r\n   */\r\n  onRelationChange?: OnRelationChange;\r\n  /**\r\n   * Invokes on progress change. Chart undoes operation if method return false or error.\r\n   */\r\n  onProgressChange?: (\r\n    task: Task,\r\n    children: Task[]\r\n  ) => void | boolean | Promise<void> | Promise<boolean>;\r\n  /**\r\n   * Invokes on delete selected task. Chart undoes operation if method return false or error.\r\n   */\r\n  onDelete?: (task: Task) => void | boolean | Promise<void> | Promise<boolean>;\r\n  /**\r\n   * Invokes on expander on task list\r\n   */\r\n  onExpanderClick?: (task: Task) => void;\r\n}\r\n\r\nexport interface DisplayOption {\r\n  viewMode?: ViewMode;\r\n  viewDate?: Date;\r\n  preStepsCount?: number;\r\n  /**\r\n   * Specifies the month name language. Able formats: ISO 639-2, Java Locale\r\n   */\r\n  locale?: string;\r\n  rtl?: boolean;\r\n}\r\n\r\nexport interface StylingOption {\r\n  headerHeight?: number;\r\n  columnWidth?: number;\r\n  listCellWidth?: string;\r\n  rowHeight?: number;\r\n  relationCircleOffset?: number;\r\n  relationCircleRadius?: number;\r\n  ganttHeight?: number;\r\n  barCornerRadius?: number;\r\n  handleWidth?: number;\r\n  fontFamily?: string;\r\n  fontSize?: string;\r\n  /**\r\n   * How many of row width can be taken by task.\r\n   * From 0 to 100\r\n   */\r\n  barFill?: number;\r\n  barProgressColor?: string;\r\n  barProgressSelectedColor?: string;\r\n  barBackgroundColor?: string;\r\n  barBackgroundSelectedColor?: string;\r\n  projectProgressColor?: string;\r\n  projectProgressSelectedColor?: string;\r\n  projectBackgroundColor?: string;\r\n  projectBackgroundSelectedColor?: string;\r\n  milestoneBackgroundColor?: string;\r\n  milestoneBackgroundSelectedColor?: string;\r\n  arrowColor?: string;\r\n  arrowIndent?: number;\r\n  todayColor?: string;\r\n  TooltipContent?: React.FC<{\r\n    task: Task;\r\n    fontSize: string;\r\n    fontFamily: string;\r\n  }>;\r\n  TaskListHeader?: React.FC<{\r\n    headerHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n  }>;\r\n  TaskListTable?: React.FC<{\r\n    rowHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n    locale: string;\r\n    tasks: Task[];\r\n    selectedTaskId: string;\r\n    /**\r\n     * Sets selected task by id\r\n     */\r\n    setSelectedTask: (taskId: string) => void;\r\n    onExpanderClick: (task: Task) => void;\r\n  }>;\r\n}\r\n\r\nexport interface GanttProps extends EventOption, DisplayOption, StylingOption {\r\n  tasks: Task[];\r\n}\r\n","import { Task, ViewMode } from \"../types/public-types\";\r\nimport DateTimeFormatOptions = Intl.DateTimeFormatOptions;\r\nimport DateTimeFormat = Intl.DateTimeFormat;\r\n\r\ntype DateHelperScales =\r\n  | \"year\"\r\n  | \"month\"\r\n  | \"day\"\r\n  | \"hour\"\r\n  | \"minute\"\r\n  | \"second\"\r\n  | \"millisecond\";\r\n\r\nconst intlDTCache = {};\r\nexport const getCachedDateTimeFormat = (\r\n  locString: string | string[],\r\n  opts: DateTimeFormatOptions = {}\r\n): DateTimeFormat => {\r\n  const key = JSON.stringify([locString, opts]);\r\n  let dtf = intlDTCache[key];\r\n  if (!dtf) {\r\n    dtf = new Intl.DateTimeFormat(locString, opts);\r\n    intlDTCache[key] = dtf;\r\n  }\r\n  return dtf;\r\n};\r\n\r\nexport const addToDate = (\r\n  date: Date,\r\n  quantity: number,\r\n  scale: DateHelperScales\r\n) => {\r\n  const newDate = new Date(\r\n    date.getFullYear() + (scale === \"year\" ? quantity : 0),\r\n    date.getMonth() + (scale === \"month\" ? quantity : 0),\r\n    date.getDate() + (scale === \"day\" ? quantity : 0),\r\n    date.getHours() + (scale === \"hour\" ? quantity : 0),\r\n    date.getMinutes() + (scale === \"minute\" ? quantity : 0),\r\n    date.getSeconds() + (scale === \"second\" ? quantity : 0),\r\n    date.getMilliseconds() + (scale === \"millisecond\" ? quantity : 0)\r\n  );\r\n  return newDate;\r\n};\r\n\r\nexport const startOfDate = (date: Date, scale: DateHelperScales) => {\r\n  const scores = [\r\n    \"millisecond\",\r\n    \"second\",\r\n    \"minute\",\r\n    \"hour\",\r\n    \"day\",\r\n    \"month\",\r\n    \"year\",\r\n  ];\r\n\r\n  const shouldReset = (_scale: DateHelperScales) => {\r\n    const maxScore = scores.indexOf(scale);\r\n    return scores.indexOf(_scale) <= maxScore;\r\n  };\r\n  const newDate = new Date(\r\n    date.getFullYear(),\r\n    shouldReset(\"year\") ? 0 : date.getMonth(),\r\n    shouldReset(\"month\") ? 1 : date.getDate(),\r\n    shouldReset(\"day\") ? 0 : date.getHours(),\r\n    shouldReset(\"hour\") ? 0 : date.getMinutes(),\r\n    shouldReset(\"minute\") ? 0 : date.getSeconds(),\r\n    shouldReset(\"second\") ? 0 : date.getMilliseconds()\r\n  );\r\n  return newDate;\r\n};\r\n\r\nexport const ganttDateRange = (\r\n  tasks: Task[],\r\n  viewMode: ViewMode,\r\n  preStepsCount: number\r\n) => {\r\n  let newStartDate: Date = tasks[0].start;\r\n  let newEndDate: Date = tasks[0].start;\r\n  for (const task of tasks) {\r\n    if (task.start < newStartDate) {\r\n      newStartDate = task.start;\r\n    }\r\n    if (task.end > newEndDate) {\r\n      newEndDate = task.end;\r\n    }\r\n  }\r\n  switch (viewMode) {\r\n    case ViewMode.Year:\r\n      newStartDate = addToDate(newStartDate, -1, \"year\");\r\n      newStartDate = startOfDate(newStartDate, \"year\");\r\n      newEndDate = addToDate(newEndDate, 1, \"year\");\r\n      newEndDate = startOfDate(newEndDate, \"year\");\r\n      break;\r\n    case ViewMode.Month:\r\n      newStartDate = addToDate(newStartDate, -1 * preStepsCount, \"month\");\r\n      newStartDate = startOfDate(newStartDate, \"month\");\r\n      newEndDate = addToDate(newEndDate, 1, \"year\");\r\n      newEndDate = startOfDate(newEndDate, \"year\");\r\n      break;\r\n    case ViewMode.Week:\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newStartDate = addToDate(\r\n        getMonday(newStartDate),\r\n        -7 * preStepsCount,\r\n        \"day\"\r\n      );\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newEndDate = addToDate(newEndDate, 1.5, \"month\");\r\n      break;\r\n    case ViewMode.Day:\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newStartDate = addToDate(newStartDate, -1 * preStepsCount, \"day\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newEndDate = addToDate(newEndDate, 19, \"day\");\r\n      break;\r\n    case ViewMode.QuarterDay:\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newStartDate = addToDate(newStartDate, -1 * preStepsCount, \"day\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newEndDate = addToDate(newEndDate, 66, \"hour\"); // 24(1 day)*3 - 6\r\n      break;\r\n    case ViewMode.HalfDay:\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newStartDate = addToDate(newStartDate, -1 * preStepsCount, \"day\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newEndDate = addToDate(newEndDate, 108, \"hour\"); // 24(1 day)*5 - 12\r\n      break;\r\n    case ViewMode.Hour:\r\n      newStartDate = startOfDate(newStartDate, \"hour\");\r\n      newStartDate = addToDate(newStartDate, -1 * preStepsCount, \"hour\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newEndDate = addToDate(newEndDate, 1, \"day\");\r\n      break;\r\n  }\r\n  return [newStartDate, newEndDate];\r\n};\r\n\r\nexport const seedDates = (\r\n  startDate: Date,\r\n  endDate: Date,\r\n  viewMode: ViewMode\r\n) => {\r\n  let currentDate: Date = new Date(startDate);\r\n  const dates: Date[] = [currentDate];\r\n  while (currentDate < endDate) {\r\n    switch (viewMode) {\r\n      case ViewMode.Year:\r\n        currentDate = addToDate(currentDate, 1, \"year\");\r\n        break;\r\n      case ViewMode.Month:\r\n        currentDate = addToDate(currentDate, 1, \"month\");\r\n        break;\r\n      case ViewMode.Week:\r\n        currentDate = addToDate(currentDate, 7, \"day\");\r\n        break;\r\n      case ViewMode.Day:\r\n        currentDate = addToDate(currentDate, 1, \"day\");\r\n        break;\r\n      case ViewMode.HalfDay:\r\n        currentDate = addToDate(currentDate, 12, \"hour\");\r\n        break;\r\n      case ViewMode.QuarterDay:\r\n        currentDate = addToDate(currentDate, 6, \"hour\");\r\n        break;\r\n      case ViewMode.Hour:\r\n        currentDate = addToDate(currentDate, 1, \"hour\");\r\n        break;\r\n    }\r\n    dates.push(currentDate);\r\n  }\r\n  return dates;\r\n};\r\n\r\nexport const getLocaleMonth = (date: Date, locale: string) => {\r\n  let bottomValue = getCachedDateTimeFormat(locale, {\r\n    month: \"long\",\r\n  }).format(date);\r\n  bottomValue = bottomValue.replace(\r\n    bottomValue[0],\r\n    bottomValue[0].toLocaleUpperCase()\r\n  );\r\n  return bottomValue;\r\n};\r\n\r\nexport const getLocalDayOfWeek = (\r\n  date: Date,\r\n  locale: string,\r\n  format?: \"long\" | \"short\" | \"narrow\" | undefined\r\n) => {\r\n  let bottomValue = getCachedDateTimeFormat(locale, {\r\n    weekday: format,\r\n  }).format(date);\r\n  bottomValue = bottomValue.replace(\r\n    bottomValue[0],\r\n    bottomValue[0].toLocaleUpperCase()\r\n  );\r\n  return bottomValue;\r\n};\r\n\r\n/**\r\n * Returns monday of current week\r\n * @param date date for modify\r\n */\r\nconst getMonday = (date: Date) => {\r\n  const day = date.getDay();\r\n  const diff = date.getDate() - day + (day === 0 ? -6 : 1); // adjust when day is sunday\r\n  return new Date(date.setDate(diff));\r\n};\r\n\r\nexport const getWeekNumberISO8601 = (date: Date) => {\r\n  const tmpDate = new Date(date.valueOf());\r\n  const dayNumber = (tmpDate.getDay() + 6) % 7;\r\n  tmpDate.setDate(tmpDate.getDate() - dayNumber + 3);\r\n  const firstThursday = tmpDate.valueOf();\r\n  tmpDate.setMonth(0, 1);\r\n  if (tmpDate.getDay() !== 4) {\r\n    tmpDate.setMonth(0, 1 + ((4 - tmpDate.getDay() + 7) % 7));\r\n  }\r\n  const weekNumber = (\r\n    1 + Math.ceil((firstThursday - tmpDate.valueOf()) / 604800000)\r\n  ).toString();\r\n\r\n  if (weekNumber.length === 1) {\r\n    return `0${weekNumber}`;\r\n  } else {\r\n    return weekNumber;\r\n  }\r\n};\r\n\r\nexport const getDaysInMonth = (month: number, year: number) => {\r\n  return new Date(year, month + 1, 0).getDate();\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./task-list-header.module.css\";\r\n\r\nexport const TaskListHeaderDefault: React.FC<{\r\n  headerHeight: number;\r\n  rowWidth: string;\r\n  fontFamily: string;\r\n  fontSize: string;\r\n}> = ({ headerHeight, fontFamily, fontSize, rowWidth }) => {\r\n  return (\r\n    <div\r\n      className={styles.ganttTable}\r\n      style={{\r\n        fontFamily: fontFamily,\r\n        fontSize: fontSize,\r\n      }}\r\n    >\r\n      <div\r\n        className={styles.ganttTable_Header}\r\n        style={{\r\n          height: headerHeight - 2,\r\n        }}\r\n      >\r\n        <div\r\n          className={styles.ganttTable_HeaderItem}\r\n          style={{\r\n            minWidth: rowWidth,\r\n          }}\r\n        >\r\n          {/* &nbsp; TASK LIST */}\r\n        </div>\r\n        <div\r\n          className={styles.ganttTable_HeaderSeparator}\r\n          style={{\r\n            height: headerHeight * 0.5,\r\n            marginTop: headerHeight * 0.2,\r\n          }}\r\n        />\r\n        <div\r\n          className={styles.ganttTable_HeaderItem}\r\n          style={{\r\n            minWidth: rowWidth,\r\n            textAlign: \"center\",\r\n          }}\r\n        >\r\n          {/* &nbsp;From */}\r\n        </div>\r\n        <div\r\n          className={styles.ganttTable_HeaderSeparator}\r\n          style={{\r\n            height: headerHeight * 0.5,\r\n            marginTop: headerHeight * 0.25,\r\n          }}\r\n        />\r\n        <div\r\n          className={styles.ganttTable_HeaderItem}\r\n          style={{\r\n            minWidth: rowWidth,\r\n          }}\r\n        >\r\n          {/* &nbsp;To */}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","const chipColors: ChipColors = {\r\n  blue: {\r\n    text: \"#518EE0\",\r\n    background: \"#DAF0FB\",\r\n  },\r\n  yellow: {\r\n    text: \"#987901\",\r\n    background: \"#FEEBA3\",\r\n  },\r\n  green: {\r\n    text: \"#2D862D\",\r\n    background: \"#ADE3AC\",\r\n  },\r\n  red: {\r\n    text: \"#f06\",\r\n    background: \"#FEA3C8\",\r\n  },\r\n  purple: {\r\n    text: \"#306\",\r\n    background: \"#B770FE\",\r\n  },\r\n  brown: {\r\n    text: \"#930\",\r\n    background: \"#FE9A70\",\r\n  },\r\n  rose: {\r\n    text: \"#c3c\",\r\n    background: \"#EBADEB\",\r\n  },\r\n  kaki: {\r\n    text: \"#E78336\",\r\n    background: \"#FCEFD4\",\r\n  },\r\n  orange: {\r\n    text: \"#a13b08\",\r\n    background: \"#fb9b72\",\r\n  },\r\n};\r\n\r\nexport const useProvideChipColors = () => {\r\n  const resolveChipColor = (\r\n    badgeColor: string | undefined,\r\n    badgeTitle: string | undefined\r\n  ) =>\r\n    badgeColor\r\n      ? badgeTitle === \"Setup\"\r\n        ? \"#022D5F\"\r\n        : chipColors[badgeColor as keyof ChipColors].background\r\n      : undefined;\r\n\r\n  const resolveChipLabelColor = (\r\n    badgeColor: string | undefined,\r\n    badgeTitle: string | undefined\r\n  ) =>\r\n    badgeColor\r\n      ? badgeTitle === \"Setup\"\r\n        ? \"white\"\r\n        : chipColors[badgeColor as keyof ChipColors].text\r\n      : undefined;\r\n\r\n  return { resolveChipColor, resolveChipLabelColor };\r\n};\r\n\r\ninterface ChipColors {\r\n  blue: Blue;\r\n  yellow: Blue;\r\n  green: Blue;\r\n  red: Blue;\r\n  purple: Blue;\r\n  brown: Blue;\r\n  rose: Blue;\r\n  kaki: Blue;\r\n  orange: Blue;\r\n}\r\n\r\ninterface Blue {\r\n  text: string;\r\n  background: string;\r\n}\r\n","import React, { useMemo } from \"react\";\r\nimport styles from \"./task-list-table.module.css\";\r\nimport { Task } from \"../../types/public-types\";\r\nimport ChevronRightIcon from \"@mui/icons-material/ChevronRight\";\r\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\r\nimport { useProvideChipColors } from \"./useProvideChipColors\";\r\n\r\nconst localeDateStringCache = {};\r\nconst toLocaleDateStringFactory =\r\n  (locale: string) =>\r\n  (date: Date, dateTimeOptions: Intl.DateTimeFormatOptions) => {\r\n    const key = date.toString();\r\n    let lds = localeDateStringCache[key];\r\n    if (!lds) {\r\n      lds = date.toLocaleDateString(locale, dateTimeOptions);\r\n      localeDateStringCache[key] = lds;\r\n    }\r\n    return lds;\r\n  };\r\n\r\nfunction formatDate(inputDate: string) {\r\n  const dateObject = new Date(inputDate);\r\n  /* const options = { day: '2-digit', month: '2-digit', year: 'numeric' }; */\r\n  return dateObject.toLocaleDateString(\"en-GB\", {\r\n    day: \"2-digit\",\r\n    month: \"2-digit\",\r\n  });\r\n}\r\nconst dateTimeOptions: Intl.DateTimeFormatOptions = {\r\n  weekday: \"short\",\r\n  year: \"numeric\",\r\n  month: \"long\",\r\n  day: \"numeric\",\r\n};\r\n\r\nexport const TaskListTableDefault: React.FC<{\r\n  rowHeight: number;\r\n  rowWidth: string;\r\n  fontFamily: string;\r\n  fontSize: string;\r\n  locale: string;\r\n  tasks: Task[];\r\n  selectedTaskId: string;\r\n  setSelectedTask: (taskId: string) => void;\r\n  onExpanderClick: (task: Task) => void;\r\n}> = ({\r\n  rowHeight,\r\n  rowWidth,\r\n  tasks,\r\n  fontFamily,\r\n  fontSize,\r\n  locale,\r\n  onExpanderClick,\r\n}) => {\r\n  const { resolveChipColor, resolveChipLabelColor } = useProvideChipColors();\r\n  const toLocaleDateString = useMemo(\r\n    () => toLocaleDateStringFactory(locale),\r\n    [locale]\r\n  );\r\n\r\n  return (\r\n    <div\r\n      className={styles.taskListWrapper}\r\n      style={{\r\n        fontFamily: fontFamily,\r\n        fontSize: fontSize,\r\n      }}\r\n    >\r\n      {tasks.map(t => {\r\n        let expanderSymbol = null;\r\n        if (t.hideChildren === false) {\r\n          expanderSymbol = <ExpandMoreIcon />;\r\n        } else if (t.hideChildren === true) {\r\n          expanderSymbol = <ChevronRightIcon /> /* \"â–¶\" */;\r\n        }\r\n\r\n        return (\r\n          <div\r\n            className={styles.taskListTableRow}\r\n            style={{ height: rowHeight }}\r\n            key={`${t.id}row`}\r\n          >\r\n            <div\r\n              className={styles.taskListCell}\r\n              style={{\r\n                minWidth: \"270px\",\r\n                maxWidth: rowWidth,\r\n              }}\r\n              title={t.name}\r\n            >\r\n              <div className={styles.taskListNameWrapper}>\r\n                <div\r\n                  className={\r\n                    expanderSymbol\r\n                      ? styles.taskListExpander\r\n                      : styles.taskListEmptyExpander\r\n                  }\r\n                  onClick={() => onExpanderClick(t)}\r\n                >\r\n                  {expanderSymbol}\r\n                </div>\r\n                {t.type === \"project\" ? (\r\n                  <div style={{ margin: \"auto\" }}>\r\n                    <div\r\n                      style={{\r\n                        background: resolveChipColor(t.color, \"Title chip\"),\r\n                        color: resolveChipLabelColor(t.color, \"Title chip\"),\r\n                        padding: \"0.5rem 1rem\",\r\n                        borderRadius: \"50px\",\r\n                        fontWeight: \"600\",\r\n                        fontSize: \"12px\",\r\n                        maxHeight: \"30px\",\r\n                        lineHeight: 1,\r\n                        maxWidth: \"235px\",\r\n                        whiteSpace: \"nowrap\",\r\n                        overflow: \"hidden\",\r\n                        textOverflow: \"ellipsis\",\r\n                      }}\r\n                    >\r\n                      {t.name}\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <div style={{ margin: \"auto\", fontSize: \"12px\" }}>\r\n                    {t.name}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            {/*             <div\r\n              className={styles.taskListCell}\r\n              style={{\r\n                minWidth: rowWidth,\r\n                maxWidth: rowWidth,\r\n              }}\r\n            >\r\n              &nbsp;{formatDate(toLocaleDateString(t.start, dateTimeOptions))}\r\n            </div> */}\r\n            <div\r\n              className={styles.taskListCell}\r\n              style={{\r\n                minWidth: rowWidth,\r\n                maxWidth: rowWidth,\r\n                width: \"67%\",\r\n                textAlign: \"center\",\r\n                color: \"#747474\",\r\n                fontSize: \"12px\",\r\n              }}\r\n            >\r\n              &nbsp;\r\n              {`${formatDate(toLocaleDateString(t.start, dateTimeOptions))\r\n                .split(\"/\")\r\n                .join(\".\")} - ${formatDate(\r\n                toLocaleDateString(t.end, dateTimeOptions)\r\n              )\r\n                .split(\"/\")\r\n                .join(\".\")}`}\r\n              {/* &nbsp;{formatDate(toLocaleDateString(t.end, dateTimeOptions))} */}\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n","import React, { SyntheticEvent, useRef, useEffect } from \"react\";\r\nimport styles from \"./vertical-scroll.module.css\";\r\n\r\nexport const VerticalScroll: React.FC<{\r\n  scroll: number;\r\n  ganttHeight: number;\r\n  ganttFullHeight: number;\r\n  headerHeight: number;\r\n  rtl: boolean;\r\n  onScroll: (event: SyntheticEvent<HTMLDivElement>) => void;\r\n}> = ({\r\n  scroll,\r\n  ganttHeight,\r\n  ganttFullHeight,\r\n  headerHeight,\r\n  rtl,\r\n  onScroll,\r\n}) => {\r\n  const scrollRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (scrollRef.current) {\r\n      scrollRef.current.scrollTop = scroll;\r\n    }\r\n  }, [scroll]);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        height: ganttHeight,\r\n        marginTop: headerHeight,\r\n        marginLeft: rtl ? \"\" : \"-1rem\",\r\n      }}\r\n      className={styles.scroll}\r\n      onScroll={onScroll}\r\n      ref={scrollRef}\r\n    >\r\n      <div style={{ height: ganttFullHeight, width: 1 }} />\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useRef } from \"react\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport { Task } from \"../../types/public-types\";\r\n\r\nexport type TaskListProps = {\r\n  headerHeight: number;\r\n  rowWidth: string;\r\n  fontFamily: string;\r\n  fontSize: string;\r\n  rowHeight: number;\r\n  ganttHeight: number;\r\n  scrollY: number;\r\n  locale: string;\r\n  tasks: Task[];\r\n  taskListRef: React.RefObject<HTMLDivElement>;\r\n  horizontalContainerClass?: string;\r\n  selectedTask: BarTask | undefined;\r\n  setSelectedTask: (task: string) => void;\r\n  onExpanderClick: (task: Task) => void;\r\n  TaskListHeader: React.FC<{\r\n    headerHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n  }>;\r\n  TaskListTable: React.FC<{\r\n    rowHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n    locale: string;\r\n    tasks: Task[];\r\n    selectedTaskId: string;\r\n    setSelectedTask: (taskId: string) => void;\r\n    onExpanderClick: (task: Task) => void;\r\n  }>;\r\n};\r\n\r\nexport const TaskList: React.FC<TaskListProps> = ({\r\n  headerHeight,\r\n  fontFamily,\r\n  fontSize,\r\n  rowWidth,\r\n  rowHeight,\r\n  scrollY,\r\n  tasks,\r\n  selectedTask,\r\n  setSelectedTask,\r\n  onExpanderClick,\r\n  locale,\r\n  ganttHeight,\r\n  taskListRef,\r\n  horizontalContainerClass,\r\n  TaskListHeader,\r\n  TaskListTable,\r\n}) => {\r\n  const horizontalContainerRef = useRef<HTMLDivElement>(null);\r\n  useEffect(() => {\r\n    if (horizontalContainerRef.current) {\r\n      horizontalContainerRef.current.scrollTop = scrollY;\r\n    }\r\n  }, [scrollY]);\r\n\r\n  const headerProps = {\r\n    headerHeight,\r\n    fontFamily,\r\n    fontSize,\r\n    rowWidth,\r\n  };\r\n  const selectedTaskId = selectedTask ? selectedTask.id : \"\";\r\n  const tableProps = {\r\n    rowHeight,\r\n    rowWidth,\r\n    fontFamily,\r\n    fontSize,\r\n    tasks,\r\n    locale,\r\n    selectedTaskId: selectedTaskId,\r\n    setSelectedTask,\r\n    onExpanderClick,\r\n  };\r\n\r\n  return (\r\n    <div ref={taskListRef}>\r\n      <TaskListHeader {...headerProps} />\r\n      <div\r\n        ref={horizontalContainerRef}\r\n        className={horizontalContainerClass}\r\n        style={ganttHeight ? { height: ganttHeight } : {}}\r\n      >\r\n        <TaskListTable {...tableProps} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { ReactChild } from \"react\";\r\nimport { Task } from \"../../types/public-types\";\r\nimport { addToDate } from \"../../helpers/date-helper\";\r\nimport styles from \"./grid.module.css\";\r\n\r\nexport type GridBodyProps = {\r\n  tasks: Task[];\r\n  dates: Date[];\r\n  svgWidth: number;\r\n  rowHeight: number;\r\n  columnWidth: number;\r\n  todayColor: string;\r\n  rtl: boolean;\r\n};\r\nexport const GridBody: React.FC<GridBodyProps> = ({\r\n  tasks,\r\n  dates,\r\n  rowHeight,\r\n  svgWidth,\r\n  columnWidth,\r\n  todayColor,\r\n  rtl,\r\n}) => {\r\n  let y = 0;\r\n  const gridRows: ReactChild[] = [];\r\n  const rowLines: ReactChild[] = [\r\n    <line\r\n      key=\"RowLineFirst\"\r\n      x=\"0\"\r\n      y1={0}\r\n      x2={svgWidth}\r\n      y2={0}\r\n      className={styles.gridRowLine}\r\n    />,\r\n  ];\r\n  for (const task of tasks) {\r\n    gridRows.push(\r\n      <rect\r\n        key={\"Row\" + task.id}\r\n        x=\"0\"\r\n        y={y}\r\n        width={svgWidth}\r\n        height={rowHeight}\r\n        className={styles.gridRow}\r\n      />\r\n    );\r\n    rowLines.push(\r\n      <line\r\n        key={\"RowLine\" + task.id}\r\n        x=\"0\"\r\n        y1={y + rowHeight}\r\n        x2={svgWidth}\r\n        y2={y + rowHeight}\r\n        className={styles.gridRowLine}\r\n      />\r\n    );\r\n    y += rowHeight;\r\n  }\r\n\r\n  const now = new Date();\r\n  let tickX = 0;\r\n  const ticks: ReactChild[] = [];\r\n  let today: ReactChild = <rect />;\r\n  for (let i = 0; i < dates.length; i++) {\r\n    const date = dates[i];\r\n    ticks.push(\r\n      <line\r\n        key={date.getTime()}\r\n        x1={tickX}\r\n        y1={0}\r\n        x2={tickX}\r\n        y2={y}\r\n        className={styles.gridTick}\r\n      />\r\n    );\r\n    if (\r\n      (i + 1 !== dates.length &&\r\n        date.getTime() < now.getTime() &&\r\n        dates[i + 1].getTime() >= now.getTime()) ||\r\n      // if current date is last\r\n      (i !== 0 &&\r\n        i + 1 === dates.length &&\r\n        date.getTime() < now.getTime() &&\r\n        addToDate(\r\n          date,\r\n          date.getTime() - dates[i - 1].getTime(),\r\n          \"millisecond\"\r\n        ).getTime() >= now.getTime())\r\n    ) {\r\n      today = (\r\n        <rect\r\n          x={tickX}\r\n          y={0}\r\n          width={columnWidth}\r\n          height={y}\r\n          fill={todayColor}\r\n        />\r\n      );\r\n    }\r\n    // rtl for today\r\n    if (\r\n      rtl &&\r\n      i + 1 !== dates.length &&\r\n      date.getTime() >= now.getTime() &&\r\n      dates[i + 1].getTime() < now.getTime()\r\n    ) {\r\n      today = (\r\n        <rect\r\n          x={tickX + columnWidth}\r\n          y={0}\r\n          width={columnWidth}\r\n          height={y}\r\n          fill={todayColor}\r\n        />\r\n      );\r\n    }\r\n    tickX += columnWidth;\r\n  }\r\n  return (\r\n    <g className=\"gridBody\">\r\n      <g className=\"rows\">{gridRows}</g>\r\n      <g className=\"rowLines\">{rowLines}</g>\r\n      <g className=\"ticks\">{ticks}</g>\r\n      <g className=\"today\">{today}</g>\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { GridBody, GridBodyProps } from \"./grid-body\";\r\n\r\nexport type GridProps = GridBodyProps;\r\nexport const Grid: React.FC<GridProps> = props => {\r\n  return (\r\n    <g className=\"grid\">\r\n      <GridBody {...props} />\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./calendar.module.css\";\r\n\r\ntype TopPartOfCalendarProps = {\r\n  value: string;\r\n  x1Line: number;\r\n  y1Line: number;\r\n  y2Line: number;\r\n  xText: number;\r\n  yText: number;\r\n};\r\n\r\nexport const TopPartOfCalendar: React.FC<TopPartOfCalendarProps> = ({\r\n  value,\r\n  x1Line,\r\n  y1Line,\r\n  y2Line,\r\n  xText,\r\n  yText,\r\n}) => {\r\n  return (\r\n    <g className=\"calendarTop\">\r\n      <line\r\n        x1={x1Line}\r\n        y1={y1Line}\r\n        x2={x1Line}\r\n        y2={y2Line}\r\n        className={styles.calendarTopTick}\r\n        key={value + \"line\"}\r\n      />\r\n      <text\r\n        key={value + \"text\"}\r\n        y={yText}\r\n        x={xText}\r\n        className={styles.calendarTopText}\r\n      >\r\n        {value}\r\n      </text>\r\n    </g>\r\n  );\r\n};\r\n","import React, { ReactChild } from \"react\";\r\nimport { ViewMode } from \"../../types/public-types\";\r\nimport { TopPartOfCalendar } from \"./top-part-of-calendar\";\r\nimport {\r\n  getCachedDateTimeFormat,\r\n  getDaysInMonth,\r\n  getLocalDayOfWeek,\r\n  getLocaleMonth,\r\n  getWeekNumberISO8601,\r\n} from \"../../helpers/date-helper\";\r\nimport { DateSetup } from \"../../types/date-setup\";\r\nimport styles from \"./calendar.module.css\";\r\n\r\nexport type CalendarProps = {\r\n  dateSetup: DateSetup;\r\n  locale: string;\r\n  viewMode: ViewMode;\r\n  rtl: boolean;\r\n  headerHeight: number;\r\n  columnWidth: number;\r\n  fontFamily: string;\r\n  fontSize: string;\r\n};\r\n\r\nexport const Calendar: React.FC<CalendarProps> = ({\r\n  dateSetup,\r\n  locale,\r\n  viewMode,\r\n  rtl,\r\n  headerHeight,\r\n  columnWidth,\r\n  fontFamily,\r\n  fontSize,\r\n}) => {\r\n  const getCalendarValuesForYear = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    for (let i = 0; i < dateSetup.dates.length; i++) {\r\n      const date = dateSetup.dates[i];\r\n      const bottomValue = date.getFullYear();\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getFullYear()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * i + columnWidth * 0.5}\r\n          className={styles.calendarBottomText}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n      if (\r\n        i === 0 ||\r\n        date.getFullYear() !== dateSetup.dates[i - 1].getFullYear()\r\n      ) {\r\n        const topValue = date.getFullYear().toString();\r\n        let xText: number;\r\n        if (rtl) {\r\n          xText = (6 + i + date.getFullYear() + 1) * columnWidth;\r\n        } else {\r\n          xText = (6 + i - date.getFullYear()) * columnWidth;\r\n        }\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue}\r\n            value={topValue}\r\n            x1Line={columnWidth * i}\r\n            y1Line={0}\r\n            y2Line={headerHeight}\r\n            xText={xText}\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  function getWeekNumber(d: Date): number {\r\n    // Copy date so don't modify original\r\n    d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));\r\n    // Set to nearest Thursday: current date + 4 - current day number\r\n    // Make Sunday's day number 7\r\n    d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay() || 7));\r\n    // Get first day of year\r\n    var yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\r\n    // Calculate full weeks to nearest Thursday\r\n    var weekNo = Math.ceil(\r\n      ((d.getTime() - yearStart.getTime()) / 86400000 + 1) / 7\r\n    );\r\n    // Return array of year and week number\r\n    return weekNo;\r\n  }\r\n\r\n  const getCalendarValuesForMonth = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    for (let i = 0; i < dateSetup.dates.length; i++) {\r\n      const date = dateSetup.dates[i];\r\n      const bottomValue = getLocaleMonth(date, locale);\r\n      bottomValues.push(\r\n        <text\r\n          key={bottomValue + date.getFullYear()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * i + columnWidth * 0.5}\r\n          className={styles.calendarBottomText}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n      if (\r\n        i === 0 ||\r\n        date.getFullYear() !== dateSetup.dates[i - 1].getFullYear()\r\n      ) {\r\n        const topValue = date.getFullYear().toString();\r\n        let xText: number;\r\n        if (rtl) {\r\n          xText = (6 + i + date.getMonth() + 1) * columnWidth;\r\n        } else {\r\n          xText = (6 + i - date.getMonth()) * columnWidth;\r\n        }\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue}\r\n            value={topValue}\r\n            x1Line={columnWidth * i}\r\n            y1Line={0}\r\n            y2Line={topDefaultHeight}\r\n            xText={xText}\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  const getCalendarValuesForWeek = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    let weeksCount: number = 1;\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    const dates = dateSetup.dates;\r\n    for (let i = dates.length - 1; i >= 0; i--) {\r\n      const date = dates[i];\r\n      let topValue = \"\";\r\n      if (i === 0 || date.getMonth() !== dates[i - 1].getMonth()) {\r\n        // top\r\n        topValue = `${getLocaleMonth(date, locale)}, ${date.getFullYear()}`;\r\n      }\r\n      // bottom\r\n      const bottomValue = `WH ${getWeekNumberISO8601(date)}`;\r\n\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getTime()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * (i + +rtl)}\r\n          className={styles.calendarBottomText}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n\r\n      if (topValue) {\r\n        // if last day is new month\r\n        if (i !== dates.length - 1) {\r\n          topValues.push(\r\n            <TopPartOfCalendar\r\n              key={topValue}\r\n              value={topValue}\r\n              x1Line={columnWidth * i + weeksCount * columnWidth}\r\n              y1Line={0}\r\n              y2Line={topDefaultHeight}\r\n              xText={columnWidth * i + columnWidth * weeksCount * 0.5}\r\n              yText={topDefaultHeight * 0.9}\r\n            />\r\n          );\r\n        }\r\n        weeksCount = 0;\r\n      }\r\n      weeksCount++;\r\n    }\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  const getCalendarValuesForDay = () => {\r\n    const topValues = [];\r\n    const bottomValues = [];\r\n    const middleValues = [];\r\n\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    const dates = dateSetup.dates;\r\n    for (let i = 0; i < dates.length; i++) {\r\n      const date = dates[i];\r\n      const weekNumber = getWeekNumber(date);\r\n      const middleValue = `WH ${weekNumber}`;\r\n      /* const bottomValue = `${getLocalDayOfWeek(date, locale, \"short\")}, ${date\r\n        .getDate()\r\n        .toString()}`; */\r\n\r\n      if (date.getDay() === 1) {\r\n        middleValues.push(\r\n          <text\r\n            key={date.getTime() + \"middle\"}\r\n            y={headerHeight * 0.65} // Adjust the y value as needed\r\n            x={columnWidth * i + columnWidth * 0.55}\r\n            className={styles.calendarMiddleText} // Add a new style for the middle text\r\n          >\r\n            {middleValue}\r\n          </text>\r\n        );\r\n      }\r\n\r\n      const bottomValue = date.toLocaleDateString(locale, {\r\n        day: \"2-digit\",\r\n        month: \"2-digit\",\r\n      });\r\n\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getTime()}\r\n          y={headerHeight * 0.9}\r\n          x={columnWidth * i + columnWidth * 0.5}\r\n          className={styles.calendarBottomText}\r\n        >\r\n          {bottomValue.split(\"/\").join(\".\")}\r\n          {/* added split join */}\r\n        </text>\r\n      );\r\n      if (\r\n        i + 1 !== dates.length &&\r\n        date.getMonth() !== dates[i + 1].getMonth()\r\n      ) {\r\n        const topValue = `${getLocaleMonth(\r\n          date,\r\n          locale\r\n        ).toUpperCase()}, ${date.getFullYear()}`;\r\n\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue + date.getFullYear()}\r\n            value={topValue}\r\n            x1Line={columnWidth * (i + 1)}\r\n            y1Line={0}\r\n            y2Line={topDefaultHeight}\r\n            xText={\r\n              columnWidth * (i + 1) -\r\n              getDaysInMonth(date.getMonth(), date.getFullYear()) *\r\n                columnWidth *\r\n                0.5\r\n            }\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n    return [topValues, bottomValues, middleValues];\r\n  };\r\n\r\n  const getCalendarValuesForPartOfDay = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    const ticks = viewMode === ViewMode.HalfDay ? 2 : 4;\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    const dates = dateSetup.dates;\r\n    for (let i = 0; i < dates.length; i++) {\r\n      const date = dates[i];\r\n      const bottomValue = getCachedDateTimeFormat(locale, {\r\n        hour: \"numeric\",\r\n      }).format(date);\r\n\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getTime()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * (i + +rtl)}\r\n          className={styles.calendarBottomText}\r\n          fontFamily={fontFamily}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n      if (i === 0 || date.getDate() !== dates[i - 1].getDate()) {\r\n        const topValue = `${getLocalDayOfWeek(\r\n          date,\r\n          locale,\r\n          \"short\"\r\n        )}, ${date.getDate()} ${getLocaleMonth(date, locale)}`;\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue + date.getFullYear()}\r\n            value={topValue}\r\n            x1Line={columnWidth * i + ticks * columnWidth}\r\n            y1Line={0}\r\n            y2Line={topDefaultHeight}\r\n            xText={columnWidth * i + ticks * columnWidth * 0.5}\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  const getCalendarValuesForHour = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    const dates = dateSetup.dates;\r\n    for (let i = 0; i < dates.length; i++) {\r\n      const date = dates[i];\r\n      const bottomValue = getCachedDateTimeFormat(locale, {\r\n        hour: \"numeric\",\r\n      }).format(date);\r\n\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getTime()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * (i + +rtl)}\r\n          className={styles.calendarBottomText}\r\n          fontFamily={fontFamily}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n      if (i !== 0 && date.getDate() !== dates[i - 1].getDate()) {\r\n        const displayDate = dates[i - 1];\r\n        const topValue = `${getLocalDayOfWeek(\r\n          displayDate,\r\n          locale,\r\n          \"long\"\r\n        )}, ${displayDate.getDate()} ${getLocaleMonth(displayDate, locale)}`;\r\n        const topPosition = (date.getHours() - 24) / 2;\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue + displayDate.getFullYear()}\r\n            value={topValue}\r\n            x1Line={columnWidth * i}\r\n            y1Line={0}\r\n            y2Line={topDefaultHeight}\r\n            xText={columnWidth * (i + topPosition)}\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  let topValues: ReactChild[] = [];\r\n  let bottomValues: ReactChild[] = [];\r\n  let middleValues: ReactChild[] = [];\r\n  switch (dateSetup.viewMode) {\r\n    case ViewMode.Year:\r\n      [topValues, bottomValues] = getCalendarValuesForYear();\r\n      break;\r\n    case ViewMode.Month:\r\n      [topValues, bottomValues] = getCalendarValuesForMonth();\r\n      break;\r\n    case ViewMode.Week:\r\n      [topValues, bottomValues] = getCalendarValuesForWeek();\r\n      break;\r\n    case ViewMode.Day:\r\n      [topValues, bottomValues, middleValues] = getCalendarValuesForDay();\r\n      break;\r\n    case ViewMode.QuarterDay:\r\n    case ViewMode.HalfDay:\r\n      [topValues, bottomValues] = getCalendarValuesForPartOfDay();\r\n      break;\r\n    case ViewMode.Hour:\r\n      [topValues, bottomValues] = getCalendarValuesForHour();\r\n  }\r\n  return (\r\n    <g className=\"calendar\" fontSize={fontSize} fontFamily={fontFamily}>\r\n      <rect\r\n        x={0}\r\n        y={0}\r\n        width={columnWidth * dateSetup.dates.length}\r\n        height={headerHeight}\r\n        className={styles.calendarHeader}\r\n      />\r\n      {bottomValues} {middleValues} {topValues}\r\n    </g>\r\n  );\r\n};\r\n","// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","import React from \"react\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\n\r\ntype ArrowProps = {\r\n  taskFrom: BarTask;\r\n  taskTo: BarTask;\r\n  rowHeight: number;\r\n  taskHeight: number;\r\n  arrowIndent: number;\r\n  rtl: boolean;\r\n};\r\nexport const Arrow: React.FC<ArrowProps> = ({\r\n  taskFrom,\r\n  taskTo,\r\n  rowHeight,\r\n  taskHeight,\r\n  arrowIndent,\r\n  rtl,\r\n}) => {\r\n  let path: string;\r\n  let trianglePoints: string;\r\n  if (rtl) {\r\n    [path, trianglePoints] = drownPathAndTriangleRTL(\r\n      taskFrom,\r\n      taskTo,\r\n      rowHeight,\r\n      taskHeight,\r\n      arrowIndent\r\n    );\r\n  } else {\r\n    [path, trianglePoints] = drownPathAndTriangle(\r\n      taskFrom,\r\n      taskTo,\r\n      rowHeight,\r\n      taskHeight,\r\n      arrowIndent\r\n    );\r\n  }\r\n\r\n  return (\r\n    <g className=\"arrow\">\r\n      <path strokeWidth=\"1.5\" d={path} fill=\"none\" />\r\n      <polygon points={trianglePoints} />\r\n    </g>\r\n  );\r\n};\r\n\r\nconst drownPathAndTriangle = (\r\n  taskFrom: BarTask,\r\n  taskTo: BarTask,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  arrowIndent: number\r\n) => {\r\n  const indexCompare = taskFrom.index > taskTo.index ? -1 : 1;\r\n  const taskToEndPosition = taskTo.y + taskHeight / 2;\r\n  const taskFromEndPosition = taskFrom.x2 + arrowIndent * 2;\r\n  const taskFromHorizontalOffsetValue =\r\n    taskFromEndPosition < taskTo.x1 ? \"\" : `H ${taskTo.x1 - arrowIndent}`;\r\n  const taskToHorizontalOffsetValue =\r\n    taskFromEndPosition > taskTo.x1\r\n      ? arrowIndent\r\n      : taskTo.x1 - taskFrom.x2 - arrowIndent;\r\n\r\n  const path = `M ${taskFrom.x2} ${taskFrom.y + taskHeight / 2} \r\n  h ${arrowIndent} \r\n  v ${(indexCompare * rowHeight) / 2} \r\n  ${taskFromHorizontalOffsetValue}\r\n  V ${taskToEndPosition} \r\n  h ${taskToHorizontalOffsetValue}`;\r\n\r\n  const trianglePoints = `${taskTo.x1},${taskToEndPosition} \r\n  ${taskTo.x1 - 5},${taskToEndPosition - 5} \r\n  ${taskTo.x1 - 5},${taskToEndPosition + 5}`;\r\n  return [path, trianglePoints];\r\n};\r\n\r\nconst drownPathAndTriangleRTL = (\r\n  taskFrom: BarTask,\r\n  taskTo: BarTask,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  arrowIndent: number\r\n) => {\r\n  const indexCompare = taskFrom.index > taskTo.index ? -1 : 1;\r\n  const taskToEndPosition = taskTo.y + taskHeight / 2;\r\n  const taskFromEndPosition = taskFrom.x1 - arrowIndent * 2;\r\n  const taskFromHorizontalOffsetValue =\r\n    taskFromEndPosition > taskTo.x2 ? \"\" : `H ${taskTo.x2 + arrowIndent}`;\r\n  const taskToHorizontalOffsetValue =\r\n    taskFromEndPosition < taskTo.x2\r\n      ? -arrowIndent\r\n      : taskTo.x2 - taskFrom.x1 + arrowIndent;\r\n\r\n  const path = `M ${taskFrom.x1} ${taskFrom.y + taskHeight / 2} \r\n  h ${-arrowIndent} \r\n  v ${(indexCompare * rowHeight) / 2} \r\n  ${taskFromHorizontalOffsetValue}\r\n  V ${taskToEndPosition} \r\n  h ${taskToHorizontalOffsetValue}`;\r\n\r\n  const trianglePoints = `${taskTo.x2},${taskToEndPosition} \r\n  ${taskTo.x2 + 5},${taskToEndPosition + 5} \r\n  ${taskTo.x2 + 5},${taskToEndPosition - 5}`;\r\n  return [path, trianglePoints];\r\n};\r\n","import React from \"react\";\r\n\r\nimport styles from \"./relation-line.module.css\";\r\n\r\ntype RelationLineProps = {\r\n  x1: number;\r\n  x2: number;\r\n  y1: number;\r\n  y2: number;\r\n};\r\n\r\nexport const RelationLine: React.FC<RelationLineProps> = ({\r\n  x1,\r\n  x2,\r\n  y1,\r\n  y2,\r\n}) => {\r\n  return (\r\n    <line x1={x1} x2={x2} y1={y1} y2={y2} className={styles.relationLine} />\r\n  );\r\n};\r\n","import { BarTask } from \"../types/bar-task\";\r\nimport { RelationMoveTarget } from \"../types/gantt-task-actions\";\r\n\r\nexport const getRelationCircleByCoordinates = (\r\n  svgP: DOMPoint,\r\n  tasks: BarTask[],\r\n  taskHalfHeight: number,\r\n  relationCircleOffset: number,\r\n  relationCircleRadius: number,\r\n  rtl: boolean\r\n): [BarTask, RelationMoveTarget] | null => {\r\n  const { x, y } = svgP;\r\n\r\n  for (let i = 0, l = tasks.length; i < l; ++i) {\r\n    const task = tasks[i];\r\n\r\n    if (\r\n      y >= task.y + taskHalfHeight - relationCircleRadius &&\r\n      y <= task.y + taskHalfHeight + relationCircleRadius\r\n    ) {\r\n      if (\r\n        x >= task.x1 - relationCircleOffset - relationCircleRadius &&\r\n        y <= task.x1 - relationCircleOffset + relationCircleRadius\r\n      ) {\r\n        return [task, rtl ? \"endOfTask\" : \"startOfTask\"];\r\n      }\r\n\r\n      if (\r\n        x >= task.x2 + relationCircleOffset - relationCircleRadius &&\r\n        y <= task.x2 + relationCircleOffset + relationCircleRadius\r\n      ) {\r\n        return [task, rtl ? \"startOfTask\" : \"endOfTask\"];\r\n      }\r\n    }\r\n  }\r\n\r\n  return null;\r\n};\r\n","import { Task } from \"../types/public-types\";\r\nimport { BarTask, TaskTypeInternal } from \"../types/bar-task\";\r\nimport { BarMoveAction } from \"../types/gantt-task-actions\";\r\n\r\nexport const convertToBarTasks = (\r\n  tasks: Task[],\r\n  dates: Date[],\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  rtl: boolean,\r\n  barProgressColor: string,\r\n  barProgressSelectedColor: string,\r\n  barBackgroundColor: string,\r\n  barBackgroundSelectedColor: string,\r\n  projectProgressColor: string,\r\n  projectProgressSelectedColor: string,\r\n  projectBackgroundColor: string,\r\n  projectBackgroundSelectedColor: string,\r\n  milestoneBackgroundColor: string,\r\n  milestoneBackgroundSelectedColor: string\r\n) => {\r\n  let barTasks = tasks.map((t, i) => {\r\n    return convertToBarTask(\r\n      t,\r\n      i,\r\n      dates,\r\n      columnWidth,\r\n      rowHeight,\r\n      taskHeight,\r\n      barCornerRadius,\r\n      handleWidth,\r\n      rtl,\r\n      barProgressColor,\r\n      barProgressSelectedColor,\r\n      barBackgroundColor,\r\n      barBackgroundSelectedColor,\r\n      projectProgressColor,\r\n      projectProgressSelectedColor,\r\n      projectBackgroundColor,\r\n      projectBackgroundSelectedColor,\r\n      milestoneBackgroundColor,\r\n      milestoneBackgroundSelectedColor\r\n    );\r\n  });\r\n  console.log(\"BARTASKS\", barTasks);\r\n  // set dependencies\r\n  barTasks = barTasks.map(task => {\r\n    const dependencies = task.dependencies || [];\r\n    for (let j = 0; j < dependencies.length; j++) {\r\n      const dependence = barTasks.findIndex(\r\n        value => value.id === dependencies[j]\r\n      );\r\n      if (dependence !== -1) {\r\n        barTasks[dependence].barChildren.push(task);\r\n\r\n        task.offset = task.x1 - barTasks[1].x1;\r\n      } else {\r\n        task.offset = 0;\r\n      }\r\n    }\r\n    return task;\r\n  });\r\n\r\n  return barTasks;\r\n};\r\n\r\nconst convertToBarTask = (\r\n  task: Task,\r\n  index: number,\r\n  dates: Date[],\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  rtl: boolean,\r\n  barProgressColor: string,\r\n  barProgressSelectedColor: string,\r\n  barBackgroundColor: string,\r\n  barBackgroundSelectedColor: string,\r\n  projectProgressColor: string,\r\n  projectProgressSelectedColor: string,\r\n  projectBackgroundColor: string,\r\n  projectBackgroundSelectedColor: string,\r\n  milestoneBackgroundColor: string,\r\n  milestoneBackgroundSelectedColor: string\r\n): BarTask => {\r\n  let barTask: BarTask;\r\n  switch (task.type) {\r\n    case \"milestone\":\r\n      barTask = convertToMilestone(\r\n        task,\r\n        index,\r\n        dates,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        milestoneBackgroundColor,\r\n        milestoneBackgroundSelectedColor\r\n      );\r\n      break;\r\n    case \"project\":\r\n      barTask = convertToBar(\r\n        task,\r\n        index,\r\n        dates,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        rtl,\r\n        projectProgressColor,\r\n        projectProgressSelectedColor,\r\n        projectBackgroundColor,\r\n        projectBackgroundSelectedColor\r\n      );\r\n      break;\r\n    default:\r\n      barTask = convertToBar(\r\n        task,\r\n        index,\r\n        dates,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        rtl,\r\n        barProgressColor,\r\n        barProgressSelectedColor,\r\n        barBackgroundColor,\r\n        barBackgroundSelectedColor\r\n      );\r\n      break;\r\n  }\r\n  return barTask;\r\n};\r\n\r\nconst convertToBar = (\r\n  task: Task,\r\n  index: number,\r\n  dates: Date[],\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  rtl: boolean,\r\n  barProgressColor: string,\r\n  barProgressSelectedColor: string,\r\n  barBackgroundColor: string,\r\n  barBackgroundSelectedColor: string\r\n): BarTask => {\r\n  let x1: number;\r\n  let x2: number;\r\n  if (rtl) {\r\n    x2 = taskXCoordinateRTL(task.start, dates, columnWidth);\r\n    x1 = taskXCoordinateRTL(task.end, dates, columnWidth);\r\n  } else {\r\n    x1 = taskXCoordinate(task.start, dates, columnWidth);\r\n    x2 = taskXCoordinate(task.end, dates, columnWidth);\r\n  }\r\n  let typeInternal: TaskTypeInternal = task.type;\r\n  if (typeInternal === \"task\" && x2 - x1 < handleWidth * 2) {\r\n    typeInternal = \"smalltask\";\r\n    x2 = x1 + handleWidth * 2;\r\n  }\r\n\r\n  const [progressWidth, progressX] = progressWithByParams(\r\n    x1,\r\n    x2,\r\n    task.progress,\r\n    rtl\r\n  );\r\n  const y = taskYCoordinate(index, rowHeight, taskHeight);\r\n  const hideChildren = task.type === \"project\" ? task.hideChildren : undefined;\r\n\r\n  const styles = {\r\n    backgroundColor: barBackgroundColor,\r\n    backgroundSelectedColor: barBackgroundSelectedColor,\r\n    progressColor: barProgressColor,\r\n    progressSelectedColor: barProgressSelectedColor,\r\n    ...task.styles,\r\n  };\r\n  return {\r\n    ...task,\r\n    typeInternal,\r\n    x1,\r\n    x2,\r\n    y,\r\n    index,\r\n    progressX,\r\n    progressWidth,\r\n    barCornerRadius,\r\n    handleWidth,\r\n    hideChildren,\r\n    height: taskHeight,\r\n    barChildren: [],\r\n    styles,\r\n  };\r\n};\r\n\r\nconst convertToMilestone = (\r\n  task: Task,\r\n  index: number,\r\n  dates: Date[],\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  milestoneBackgroundColor: string,\r\n  milestoneBackgroundSelectedColor: string\r\n): BarTask => {\r\n  const x = taskXCoordinate(task.start, dates, columnWidth);\r\n  const y = taskYCoordinate(index, rowHeight, taskHeight);\r\n\r\n  const x1 = x - taskHeight * 0.5;\r\n  const x2 = x + taskHeight * 0.5;\r\n\r\n  const rotatedHeight = taskHeight / 1.414;\r\n  const styles = {\r\n    backgroundColor: milestoneBackgroundColor,\r\n    backgroundSelectedColor: milestoneBackgroundSelectedColor,\r\n    progressColor: \"\",\r\n    progressSelectedColor: \"\",\r\n    ...task.styles,\r\n  };\r\n  return {\r\n    ...task,\r\n    end: task.start,\r\n    x1,\r\n    x2,\r\n    y,\r\n    index,\r\n    progressX: 0,\r\n    progressWidth: 0,\r\n    barCornerRadius,\r\n    handleWidth,\r\n    typeInternal: task.type,\r\n    progress: 0,\r\n    height: rotatedHeight,\r\n    hideChildren: undefined,\r\n    barChildren: [],\r\n    styles,\r\n  };\r\n};\r\n\r\nconst taskXCoordinate = (xDate: Date, dates: Date[], columnWidth: number) => {\r\n  const index = dates.findIndex(d => d.getTime() >= xDate.getTime()) - 1;\r\n\r\n  const remainderMillis = xDate.getTime() - dates[index].getTime();\r\n  const percentOfInterval =\r\n    remainderMillis / (dates[index + 1].getTime() - dates[index].getTime());\r\n  const x = index * columnWidth + percentOfInterval * columnWidth;\r\n  return x;\r\n};\r\nconst taskXCoordinateRTL = (\r\n  xDate: Date,\r\n  dates: Date[],\r\n  columnWidth: number\r\n) => {\r\n  let x = taskXCoordinate(xDate, dates, columnWidth);\r\n  x += columnWidth;\r\n  return x;\r\n};\r\nconst taskYCoordinate = (\r\n  index: number,\r\n  rowHeight: number,\r\n  taskHeight: number\r\n) => {\r\n  const y = index * rowHeight + (rowHeight - taskHeight) / 2;\r\n  return y;\r\n};\r\n\r\nexport const progressWithByParams = (\r\n  taskX1: number,\r\n  taskX2: number,\r\n  progress: number,\r\n  rtl: boolean\r\n) => {\r\n  const progressWidth = (taskX2 - taskX1) * progress * 0.01;\r\n  let progressX: number;\r\n  if (rtl) {\r\n    progressX = taskX2 - progressWidth;\r\n  } else {\r\n    progressX = taskX1;\r\n  }\r\n  return [progressWidth, progressX];\r\n};\r\n\r\nexport const progressByProgressWidth = (\r\n  progressWidth: number,\r\n  barTask: BarTask\r\n) => {\r\n  const barWidth = barTask.x2 - barTask.x1;\r\n  const progressPercent = Math.round((progressWidth * 100) / barWidth);\r\n  if (progressPercent >= 100) return 100;\r\n  else if (progressPercent <= 0) return 0;\r\n  else return progressPercent;\r\n};\r\n\r\nconst progressByX = (x: number, task: BarTask) => {\r\n  if (x >= task.x2) return 100;\r\n  else if (x <= task.x1) return 0;\r\n  else {\r\n    const barWidth = task.x2 - task.x1;\r\n    const progressPercent = Math.round(((x - task.x1) * 100) / barWidth);\r\n    return progressPercent;\r\n  }\r\n};\r\nconst progressByXRTL = (x: number, task: BarTask) => {\r\n  if (x >= task.x2) return 0;\r\n  else if (x <= task.x1) return 100;\r\n  else {\r\n    const barWidth = task.x2 - task.x1;\r\n    const progressPercent = Math.round(((task.x2 - x) * 100) / barWidth);\r\n    return progressPercent;\r\n  }\r\n};\r\n\r\nexport const getProgressPoint = (\r\n  progressX: number,\r\n  taskY: number,\r\n  taskHeight: number\r\n) => {\r\n  const point = [\r\n    progressX - 5,\r\n    taskY + taskHeight,\r\n    progressX + 5,\r\n    taskY + taskHeight,\r\n    progressX,\r\n    taskY + taskHeight - 8.66,\r\n  ];\r\n  return point.join(\",\");\r\n};\r\n\r\nconst startByX = (x: number, xStep: number, task: BarTask) => {\r\n  if (x >= task.x2 - task.handleWidth * 2) {\r\n    x = task.x2 - task.handleWidth * 2;\r\n  }\r\n  const steps = Math.round((x - task.x1) / xStep);\r\n  const additionalXValue = steps * xStep;\r\n  const newX = task.x1 + additionalXValue;\r\n  return newX;\r\n};\r\n\r\nconst endByX = (x: number, xStep: number, task: BarTask) => {\r\n  if (x <= task.x1 + task.handleWidth * 2) {\r\n    x = task.x1 + task.handleWidth * 2;\r\n  }\r\n  const steps = Math.round((x - task.x2) / xStep);\r\n  const additionalXValue = steps * xStep;\r\n  const newX = task.x2 + additionalXValue;\r\n  return newX;\r\n};\r\n\r\nconst moveByX = (\r\n  x: number,\r\n  xStep: number,\r\n  task: BarTask,\r\n  prevTask: BarTask | undefined\r\n) => {\r\n  const steps = Math.round((x - task.x1) / xStep);\r\n  const additionalXValue = steps * xStep;\r\n  let newX1 = task.x1 + additionalXValue;\r\n  newX1 = prevTask ? (newX1 < prevTask.x2 ? prevTask.x2 : newX1) : newX1;\r\n  const newX2 = newX1 + task.x2 - task.x1;\r\n  //console.log(\"TASK MOVEX\", task.id, newX1, newX2);\r\n  return [newX1, newX2];\r\n};\r\n\r\nconst moveByXForEach = (\r\n  task: BarTask,\r\n  newMoveX1: number,\r\n  selectedTask: BarTask\r\n) => {\r\n  const taskOffset = task.offset || 0;\r\n  const selectedTaskOffset = selectedTask.offset || 0;\r\n  const newTaskOffset = taskOffset - selectedTaskOffset;\r\n\r\n  const newX1Test = newMoveX1 + newTaskOffset;\r\n  const newX2Test = newX1Test + task.x2 - task.x1;\r\n\r\n  return { newX1Test, newX2Test };\r\n};\r\n\r\nconst dateByX = (\r\n  x: number,\r\n  taskX: number,\r\n  taskDate: Date,\r\n  xStep: number,\r\n  timeStep: number\r\n) => {\r\n  let newDate = new Date(((x - taskX) / xStep) * timeStep + taskDate.getTime());\r\n  newDate = new Date(\r\n    newDate.getTime() +\r\n      (newDate.getTimezoneOffset() - taskDate.getTimezoneOffset()) * 60000\r\n  );\r\n  return newDate;\r\n};\r\n\r\n/**\r\n * Method handles event in real time(mousemove) and on finish(mouseup)\r\n */\r\nexport const handleTaskBySVGMouseEvent = (\r\n  svgX: number,\r\n  action: BarMoveAction,\r\n  selectedTask: BarTask,\r\n  tasks: BarTask[],\r\n  xStep: number,\r\n  timeStep: number,\r\n  initEventX1Delta: number,\r\n  rtl: boolean\r\n): { isChanged: boolean; changedTask: BarTask; changedTasks: BarTask[] } => {\r\n  let result: {\r\n    isChanged: boolean;\r\n    changedTask: BarTask;\r\n    changedTasks: BarTask[];\r\n  };\r\n  switch (selectedTask.type) {\r\n    case \"milestone\":\r\n      result = handleTaskBySVGMouseEventForMilestone(\r\n        svgX,\r\n        action,\r\n        selectedTask,\r\n        tasks,\r\n        xStep,\r\n        timeStep,\r\n        initEventX1Delta\r\n      );\r\n      break;\r\n    default:\r\n      console.log(\"MOVING\");\r\n\r\n      result = handleTaskBySVGMouseEventForBar(\r\n        svgX,\r\n        action,\r\n        selectedTask,\r\n        tasks,\r\n        xStep,\r\n        timeStep,\r\n        initEventX1Delta,\r\n        rtl\r\n      );\r\n      break;\r\n  }\r\n  return result;\r\n};\r\n\r\nconst handleTaskBySVGMouseEventForBar = (\r\n  svgX: number,\r\n  action: BarMoveAction,\r\n  selectedTask: BarTask,\r\n  tasks: BarTask[],\r\n  xStep: number,\r\n  timeStep: number,\r\n  initEventX1Delta: number,\r\n  rtl: boolean\r\n): { isChanged: boolean; changedTask: BarTask; changedTasks: BarTask[] } => {\r\n  const changedTasks: BarTask[] = [];\r\n  const changedTask: BarTask = { ...selectedTask };\r\n  let isChanged = false;\r\n  //getAllBarChildrens\r\n\r\n  switch (action) {\r\n    case \"progress\":\r\n      if (rtl) {\r\n        changedTask.progress = progressByXRTL(svgX, selectedTask);\r\n      } else {\r\n        changedTask.progress = progressByX(svgX, selectedTask);\r\n      }\r\n      isChanged = changedTask.progress !== selectedTask.progress;\r\n      if (isChanged) {\r\n        const [progressWidth, progressX] = progressWithByParams(\r\n          changedTask.x1,\r\n          changedTask.x2,\r\n          changedTask.progress,\r\n          rtl\r\n        );\r\n        changedTask.progressWidth = progressWidth;\r\n        changedTask.progressX = progressX;\r\n      }\r\n      break;\r\n    case \"start\": {\r\n      const newX1 = startByX(svgX, xStep, selectedTask);\r\n      changedTask.x1 = newX1;\r\n      isChanged = changedTask.x1 !== selectedTask.x1;\r\n      if (isChanged) {\r\n        if (rtl) {\r\n          changedTask.end = dateByX(\r\n            newX1,\r\n            selectedTask.x1,\r\n            selectedTask.end,\r\n            xStep,\r\n            timeStep\r\n          );\r\n        } else {\r\n          changedTask.start = dateByX(\r\n            newX1,\r\n            selectedTask.x1,\r\n            selectedTask.start,\r\n            xStep,\r\n            timeStep\r\n          );\r\n        }\r\n        const [progressWidth, progressX] = progressWithByParams(\r\n          changedTask.x1,\r\n          changedTask.x2,\r\n          changedTask.progress,\r\n          rtl\r\n        );\r\n        changedTask.progressWidth = progressWidth;\r\n        changedTask.progressX = progressX;\r\n      }\r\n      break;\r\n    }\r\n    case \"end\": {\r\n      const newX2 = endByX(svgX, xStep, selectedTask);\r\n      changedTask.x2 = newX2;\r\n      isChanged = changedTask.x2 !== selectedTask.x2;\r\n      if (isChanged) {\r\n        if (rtl) {\r\n          changedTask.start = dateByX(\r\n            newX2,\r\n            selectedTask.x2,\r\n            selectedTask.start,\r\n            xStep,\r\n            timeStep\r\n          );\r\n        } else {\r\n          changedTask.end = dateByX(\r\n            newX2,\r\n            selectedTask.x2,\r\n            selectedTask.end,\r\n            xStep,\r\n            timeStep\r\n          );\r\n        }\r\n        const [progressWidth, progressX] = progressWithByParams(\r\n          changedTask.x1,\r\n          changedTask.x2,\r\n          changedTask.progress,\r\n          rtl\r\n        );\r\n        changedTask.progressWidth = progressWidth;\r\n        changedTask.progressX = progressX;\r\n      }\r\n      break;\r\n    }\r\n    case \"move\": {\r\n      //GET ARRAY OF DEPENDENT TASKS AND POP LAST ITEM TO SET MIN DATE RESTRICTION!\r\n      const prevDependentTask = tasks\r\n        .filter(item => selectedTask.dependencies?.includes(item.id))\r\n        .pop();\r\n\r\n      const [newMoveX1, newMoveX2] = moveByX(\r\n        svgX - initEventX1Delta,\r\n        xStep,\r\n        selectedTask,\r\n        prevDependentTask\r\n      );\r\n      isChanged = newMoveX1 !== selectedTask.x1;\r\n      if (isChanged) {\r\n        console.log(\"IZVODI SE\");\r\n\r\n        changedTask.start = dateByX(\r\n          newMoveX1,\r\n          selectedTask.x1,\r\n          selectedTask.start,\r\n          xStep,\r\n          timeStep\r\n        );\r\n        changedTask.end = dateByX(\r\n          newMoveX2,\r\n          selectedTask.x2,\r\n          selectedTask.end,\r\n          xStep,\r\n          timeStep\r\n        );\r\n\r\n        changedTask.x1 = newMoveX1;\r\n        changedTask.x2 = newMoveX2;\r\n\r\n        //changedTask.offset = changedTask.x1 - tasks[1].x1;\r\n\r\n        const [progressWidth, progressX] = progressWithByParams(\r\n          changedTask.x1,\r\n          changedTask.x2,\r\n          changedTask.progress,\r\n          rtl\r\n        );\r\n        changedTask.progressWidth = progressWidth;\r\n        changedTask.progressX = progressX;\r\n        console.log(\"IZVODI SE\", changedTask);\r\n        //if (changedTask.barChildren.length === 0)\r\n        //return { isChanged, changedTask, changedTasks };\r\n\r\n        const childrenIds = getAllBarChildrenIds(changedTask);\r\n        //const copyTasks = tasks;\r\n        tasks\r\n          .filter(t => childrenIds.includes(t.id))\r\n          .map(task => {\r\n            const { newX1Test, newX2Test } = moveByXForEach(\r\n              task,\r\n              newMoveX1,\r\n              selectedTask\r\n            );\r\n            task.start = dateByX(\r\n              newX1Test,\r\n              task.x1,\r\n              task.start,\r\n              xStep,\r\n              timeStep\r\n            );\r\n            task.end = dateByX(newX2Test, task.x2, task.end, xStep, timeStep);\r\n            //selectedTask.offset = selectedTask.x1 - tasks[1].x1;\r\n            task.x1 = newX1Test;\r\n            task.x2 = newX2Test;\r\n\r\n            const [progressWidth, progressX] = progressWithByParams(\r\n              task.x1,\r\n              task.x2,\r\n              task.progress,\r\n              rtl\r\n            );\r\n            task.progressWidth = progressWidth;\r\n            task.progressX = progressX;\r\n            changedTasks.push(task);\r\n            return task;\r\n          });\r\n\r\n        /* tasks\r\n          .filter(task => selectedTask.id === task.id)\r\n          .map(\r\n            task =>\r\n              (task.offset =\r\n                selectedTask.offset || 0 + newMoveX1 - selectedTask.x1)\r\n          ); */\r\n      }\r\n      //break;\r\n    }\r\n  }\r\n  /*   console.log(\"CHANGED TASKS\", {\r\n    isChanged,\r\n    changedTask: changedTask || selectedTask,\r\n    changedTasks,\r\n  }); */\r\n  console.log(\"CODE 1\", changedTasks);\r\n  return { isChanged, changedTask: changedTask, changedTasks };\r\n};\r\n\r\nconst handleTaskBySVGMouseEventForMilestone = (\r\n  svgX: number,\r\n  action: BarMoveAction,\r\n  selectedTask: BarTask,\r\n  tasks: BarTask[],\r\n  xStep: number,\r\n  timeStep: number,\r\n  initEventX1Delta: number\r\n): { isChanged: boolean; changedTask: BarTask; changedTasks: BarTask[] } => {\r\n  const changedTasks: BarTask[] = [];\r\n  const changedTask: BarTask = { ...selectedTask };\r\n  let isChanged = false;\r\n  switch (action) {\r\n    case \"move\": {\r\n      //fix\r\n      const prevTaskIndex =\r\n        tasks.findIndex(task => task.id === selectedTask.id) - 1;\r\n      const prevTask = tasks[prevTaskIndex];\r\n\r\n      const [newMoveX1, newMoveX2] = moveByX(\r\n        svgX - initEventX1Delta,\r\n        xStep,\r\n        selectedTask,\r\n        prevTask\r\n      );\r\n      isChanged = newMoveX1 !== selectedTask.x1;\r\n      if (isChanged) {\r\n        changedTask.start = dateByX(\r\n          newMoveX1,\r\n          selectedTask.x1,\r\n          selectedTask.start,\r\n          xStep,\r\n          timeStep\r\n        );\r\n        changedTask.end = changedTask.start;\r\n        changedTask.x1 = newMoveX1;\r\n        changedTask.x2 = newMoveX2;\r\n      }\r\n      break;\r\n    }\r\n  }\r\n  return { isChanged, changedTask, changedTasks };\r\n};\r\n\r\nfunction getAllBarChildrenIds(obj: BarTask) {\r\n  let ids: string[] = [];\r\n  if (!ids.includes(obj.id)) {\r\n    ids.push(obj.id);\r\n  }\r\n\r\n  if (obj.barChildren && obj.barChildren.length > 0) {\r\n    for (const child of obj.barChildren) {\r\n      if (!ids.includes(child.id)) {\r\n        ids.push(child.id);\r\n      }\r\n      ids = ids.concat(getAllBarChildrenIds(child));\r\n    }\r\n  }\r\n  return ids;\r\n}\r\n","import { BarTask } from \"../types/bar-task\";\r\nimport { Task } from \"../types/public-types\";\r\n\r\nexport function isKeyboardEvent(\r\n  event: React.MouseEvent | React.KeyboardEvent | React.FocusEvent\r\n): event is React.KeyboardEvent {\r\n  return (event as React.KeyboardEvent).key !== undefined;\r\n}\r\n\r\nexport function isMouseEvent(\r\n  event: React.MouseEvent | React.KeyboardEvent | React.FocusEvent\r\n): event is React.MouseEvent {\r\n  return (event as React.MouseEvent).clientX !== undefined;\r\n}\r\n\r\nexport function isBarTask(task: Task | BarTask): task is BarTask {\r\n  return (task as BarTask).x1 !== undefined;\r\n}\r\n\r\nexport function removeHiddenTasks(tasks: Task[]) {\r\n  const groupedTasks = tasks.filter(\r\n    t => t.hideChildren && t.type === \"project\"\r\n  );\r\n  if (groupedTasks.length > 0) {\r\n    for (let i = 0; groupedTasks.length > i; i++) {\r\n      const groupedTask = groupedTasks[i];\r\n      const children = getChildren(tasks, groupedTask);\r\n      tasks = tasks.filter(t => children.indexOf(t) === -1);\r\n    }\r\n  }\r\n  return tasks;\r\n}\r\n\r\nfunction getChildren(taskList: Task[], task: Task) {\r\n  let tasks: Task[] = [];\r\n  if (task.type !== \"project\") {\r\n    tasks = taskList.filter(\r\n      t => t.dependencies && t.dependencies.indexOf(task.id) !== -1\r\n    );\r\n  } else {\r\n    tasks = taskList.filter(t => t.project && t.project === task.id);\r\n  }\r\n  var taskChildren: Task[] = [];\r\n  tasks.forEach(t => {\r\n    taskChildren.push(...getChildren(taskList, t));\r\n  })\r\n  tasks = tasks.concat(tasks, taskChildren);\r\n  return tasks;\r\n}\r\n\r\nexport const sortTasks = (taskA: Task, taskB: Task) => {\r\n  const orderA = taskA.displayOrder || Number.MAX_VALUE;\r\n  const orderB = taskB.displayOrder || Number.MAX_VALUE;\r\n  if (orderA > orderB) {\r\n    return 1;\r\n  } else if (orderA < orderB) {\r\n    return -1;\r\n  } else {\r\n    return 0;\r\n  }\r\n};\r\n","/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\tvar nativeCodeString = '[native code]';\n\n\tfunction classNames() {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tif (arg.length) {\n\t\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\t\tif (inner) {\n\t\t\t\t\t\tclasses.push(inner);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\t\t\tclasses.push(arg.toString());\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","import React from \"react\";\r\nimport style from \"./bar.module.css\";\r\n\r\ntype BarDisplayProps = {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n  isSelected: boolean;\r\n  /* progress start point */\r\n  progressX: number;\r\n  progressWidth: number;\r\n  barCornerRadius: number;\r\n  styles: {\r\n    backgroundColor: string;\r\n    backgroundSelectedColor: string;\r\n    progressColor: string;\r\n    progressSelectedColor: string;\r\n  };\r\n  onMouseDown: (event: React.MouseEvent<SVGPolygonElement, MouseEvent>) => void;\r\n};\r\nexport const BarDisplay: React.FC<BarDisplayProps> = ({\r\n  x,\r\n  y,\r\n  width,\r\n  height,\r\n  isSelected,\r\n  progressX,\r\n  progressWidth,\r\n  barCornerRadius,\r\n  styles,\r\n  onMouseDown,\r\n}) => {\r\n  /*   const progressLinesBackground = {\r\n    backgroundImage:\r\n      \"linear-gradient(-45deg, rgba(255, 255, 255, 0.125) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.125) 50%, rgba(255, 255, 255, 0.125) 75%, transparent 75%, transparent)\",\r\n  }; */\r\n\r\n  /*   const getProcessColor = () => {\r\n    return isSelected ? progressLinesBackground : progressLinesBackground;\r\n  };\r\n */\r\n  /*   const getBarColor = () => {\r\n    return isSelected ? styles.backgroundSelectedColor : styles.backgroundColor;\r\n  };\r\n */\r\n  return (\r\n    <g onMouseDown={onMouseDown}>\r\n      <rect\r\n        x={x}\r\n        width={width}\r\n        y={y}\r\n        height={height}\r\n        ry={barCornerRadius}\r\n        rx={barCornerRadius}\r\n        fill={styles.backgroundSelectedColor}\r\n        className={style.barBackground}\r\n      />\r\n      <rect\r\n        x={progressX}\r\n        width={progressWidth}\r\n        y={y + 0.2}\r\n        height={height - 0.5}\r\n        ry={barCornerRadius}\r\n        rx={barCornerRadius}\r\n        fill={isSelected ? styles.backgroundColor : styles.backgroundColor}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./bar.module.css\";\r\n\r\ntype BarDateHandleProps = {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n  barCornerRadius: number;\r\n  onMouseDown: (event: React.MouseEvent<SVGRectElement, MouseEvent>) => void;\r\n};\r\nexport const BarDateHandle: React.FC<BarDateHandleProps> = ({\r\n  x,\r\n  y,\r\n  width,\r\n  height,\r\n  barCornerRadius,\r\n  onMouseDown,\r\n}) => {\r\n  return (\r\n    <rect\r\n      x={x}\r\n      y={y}\r\n      width={width}\r\n      height={height}\r\n      className={styles.barHandle}\r\n      ry={barCornerRadius}\r\n      rx={barCornerRadius}\r\n      onMouseDown={onMouseDown}\r\n    />\r\n  );\r\n};\r\n","import React from \"react\";\r\n\r\nimport cx from \"classnames\";\r\n\r\nimport styles from \"./bar-relation-handle.module.css\";\r\n\r\ntype BarRelationHandleProps = {\r\n  x: number;\r\n  y: number;\r\n  radius: number;\r\n  isRelationDrawMode: boolean;\r\n  onMouseDown: (event: React.MouseEvent<SVGCircleElement, MouseEvent>) => void;\r\n};\r\nexport const BarRelationHandle: React.FC<BarRelationHandleProps> = ({\r\n  x,\r\n  y,\r\n  radius,\r\n  isRelationDrawMode,\r\n  onMouseDown,\r\n}) => {\r\n  return (\r\n    <circle\r\n      cx={x}\r\n      cy={y}\r\n      r={radius}\r\n      className={cx(styles.barRelationHandle, {\r\n        [styles.barRelationHandle_drawMode]: isRelationDrawMode,\r\n      })}\r\n      onMouseDown={onMouseDown}\r\n      data-draw-mode={isRelationDrawMode}\r\n    />\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./bar.module.css\";\r\n\r\ntype BarProgressHandleProps = {\r\n  progressPoint: string;\r\n  onMouseDown: (event: React.MouseEvent<SVGPolygonElement, MouseEvent>) => void;\r\n};\r\nexport const BarProgressHandle: React.FC<BarProgressHandleProps> = ({\r\n  progressPoint,\r\n  onMouseDown,\r\n}) => {\r\n  return (\r\n    <polygon\r\n      className={styles.barHandle}\r\n      points={progressPoint}\r\n      onMouseDown={onMouseDown}\r\n    />\r\n  );\r\n};\r\n","import React, { useCallback } from \"react\";\r\n\r\nimport cx from \"classnames\";\r\nimport { getProgressPoint } from \"../../../helpers/bar-helper\";\r\nimport { BarDisplay } from \"./bar-display\";\r\nimport { BarDateHandle } from \"./bar-date-handle\";\r\nimport { BarRelationHandle } from \"./bar-relation-handle\";\r\nimport { BarProgressHandle } from \"./bar-progress-handle\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./bar.module.css\";\r\nimport { useProvideChipColors } from \"../../task-list/useProvideChipColors\";\r\nimport {\r\n  Tooltip,\r\n  tooltipClasses,\r\n  TooltipProps,\r\n  Typography,\r\n} from \"@mui/material\";\r\nimport { styled } from \"@mui/material/styles\";\r\nimport stylesRelationHandle from \"./bar-relation-handle.module.css\";\r\n\r\nexport const HtmlTooltip = styled(({ className, ...props }: TooltipProps) => (\r\n  <Tooltip {...props} classes={{ popper: className }} />\r\n))(() => ({\r\n  [`& .${tooltipClasses.tooltip}`]: {\r\n    color: \"#666\",\r\n    background: \"#fff\",\r\n    padding: \"1rem\",\r\n    borderRadius: \"1rem\",\r\n    boxShadow: \"0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23)\",\r\n  },\r\n}));\r\n\r\nexport const Bar: React.FC<TaskItemProps> = ({\r\n  task,\r\n  taskHalfHeight,\r\n  relationCircleOffset,\r\n  relationCircleRadius,\r\n  isProgressChangeable,\r\n  isDateChangeable,\r\n  isRelationChangeable,\r\n  isRelationDrawMode,\r\n  rtl,\r\n  onEventStart,\r\n  onRelationStart,\r\n  isSelected,\r\n}) => {\r\n  const x = false;\r\n\r\n  const { resolveChipColor, resolveChipLabelColor } = useProvideChipColors();\r\n\r\n  const onLeftRelationTriggerMouseDown = useCallback(() => {\r\n    onRelationStart(rtl ? \"endOfTask\" : \"startOfTask\", task);\r\n  }, [onRelationStart, rtl, task]);\r\n\r\n  const onRightRelationTriggerMouseDown = useCallback(() => {\r\n    onRelationStart(rtl ? \"startOfTask\" : \"endOfTask\", task);\r\n  }, [onRelationStart, rtl, task]);\r\n\r\n  const progressPoint = getProgressPoint(\r\n    +!rtl * task.progressWidth + task.progressX,\r\n    task.y,\r\n    task.height\r\n  );\r\n  const handleHeight = task.height - 2;\r\n  const taskStyle = {\r\n    ...task.styles,\r\n    backgroundColor: resolveChipLabelColor(task.color, \"test\") || \"#ededed\",\r\n    backgroundSelectedColor: resolveChipColor(task.color, \"test\") || \"#ededed\",\r\n  };\r\n  return (\r\n    <HtmlTooltip\r\n      placement=\"bottom-start\"\r\n      followCursor\r\n      title={\r\n        <React.Fragment>\r\n          <Typography\r\n            style={{ textAlign: \"center\", color: \"black\", fontSize: \"14px\" }}\r\n          >\r\n            <div style={{ margin: \"auto\" }}>{task.name}</div>\r\n          </Typography>\r\n          <pre\r\n            className={styles.tooltipDefaultContainerParagraph}\r\n          >{`${task.start.getDate()}.${\r\n            task.start.getMonth() + 1\r\n          }.${task.start.getFullYear()} - ${task.end.getDate()}.${\r\n            task.end.getMonth() + 1\r\n          }.${task.end.getFullYear()}`}</pre>\r\n          {task.end.getTime() - task.start.getTime() !== 0 && (\r\n            <p\r\n              className={styles.tooltipDefaultContainerParagraph}\r\n            >{`Duration: ${~~(\r\n              (task.end.getTime() - task.start.getTime()) /\r\n              (1000 * 60 * 60 * 24)\r\n            )} day(s)`}</p>\r\n          )}\r\n\r\n          <p className={styles.tooltipDefaultContainerParagraph}>\r\n            {!!task.progress && `Progress: ${task.progress} %`}\r\n          </p>\r\n        </React.Fragment>\r\n      }\r\n    >\r\n      <g\r\n        className={cx(\r\n          styles.barWrapper,\r\n          stylesRelationHandle.barRelationHandleWrapper\r\n        )}\r\n        tabIndex={0}\r\n      >\r\n        <BarDisplay\r\n          x={task.x1}\r\n          y={task.y + 2}\r\n          width={task.x2 - task.x1}\r\n          height={15}\r\n          progressX={task.progressX}\r\n          progressWidth={task.progressWidth} //HARDCODED TO FULL COLOR THE TASK BAR\r\n          barCornerRadius={task.barCornerRadius}\r\n          styles={taskStyle}\r\n          isSelected={isSelected}\r\n          onMouseDown={e => {\r\n            isDateChangeable && onEventStart(\"move\", task, e);\r\n          }}\r\n        />\r\n        <g className=\"handleGroup\">\r\n          {isDateChangeable && (\r\n            <g>\r\n              {/* left */}\r\n              <BarDateHandle\r\n                x={task.x1 + 1}\r\n                y={task.y + 1}\r\n                width={task.handleWidth}\r\n                height={handleHeight}\r\n                barCornerRadius={task.barCornerRadius}\r\n                onMouseDown={e => {\r\n                  onEventStart(\"start\", task, e);\r\n                }}\r\n              />\r\n              {/* right */}\r\n              <BarDateHandle\r\n                x={task.x2 - task.handleWidth - 1}\r\n                y={task.y + 1}\r\n                width={task.handleWidth}\r\n                height={handleHeight}\r\n                barCornerRadius={task.barCornerRadius}\r\n                onMouseDown={e => {\r\n                  onEventStart(\"end\", task, e);\r\n                }}\r\n              />\r\n            </g>\r\n          )}\r\n          {isRelationChangeable && (\r\n            <g>\r\n              {/* left */}\r\n              <BarRelationHandle\r\n                isRelationDrawMode={isRelationDrawMode}\r\n                x={task.x1 - relationCircleOffset}\r\n                y={task.y + taskHalfHeight}\r\n                radius={relationCircleRadius}\r\n                onMouseDown={onLeftRelationTriggerMouseDown}\r\n              />\r\n              {/* right */}\r\n              <BarRelationHandle\r\n                isRelationDrawMode={isRelationDrawMode}\r\n                x={task.x2 + relationCircleOffset}\r\n                y={task.y + taskHalfHeight}\r\n                radius={relationCircleRadius}\r\n                onMouseDown={onRightRelationTriggerMouseDown}\r\n              />\r\n            </g>\r\n          )}\r\n          {isProgressChangeable && x && (\r\n            <BarProgressHandle\r\n              progressPoint={progressPoint}\r\n              onMouseDown={e => {\r\n                onEventStart(\"progress\", task, e);\r\n              }}\r\n            />\r\n          )}\r\n        </g>\r\n      </g>\r\n    </HtmlTooltip>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport { BarRelationHandle } from \"../bar/bar-relation-handle\";\r\nimport stylesRelationHandle from \"../bar/bar-relation-handle.module.css\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./milestone.module.css\";\r\nimport { useProvideChipColors } from \"../../task-list/useProvideChipColors\";\r\n\r\nexport const Milestone: React.FC<TaskItemProps> = ({\r\n  task,\r\n  taskHalfHeight,\r\n  relationCircleOffset,\r\n  relationCircleRadius,\r\n  isDateChangeable,\r\n  isRelationChangeable,\r\n  isRelationDrawMode,\r\n  onEventStart,\r\n  onRelationStart,\r\n  isSelected,\r\n}) => {\r\n  const { resolveChipColor, resolveChipLabelColor } = useProvideChipColors();\r\n  const transform = `rotate(45 ${task.x1 + task.height * 0.356} \r\n    ${task.y + task.height * 0.85})`;\r\n  const getBarColor = () => {\r\n    return isSelected\r\n      ? resolveChipColor(task.color, \"test\") || \"#ededed\"\r\n      : resolveChipLabelColor(task.color, \"test\") || \"#ededed\";\r\n  };\r\n\r\n  return (\r\n    <g\r\n      tabIndex={0}\r\n      className={cx(\r\n        styles.milestoneWrapper,\r\n        stylesRelationHandle.barRelationHandleWrapper\r\n      )}\r\n    >\r\n      <rect\r\n        fill={getBarColor()}\r\n        x={task.x1}\r\n        width={task.height}\r\n        y={task.y}\r\n        height={task.height}\r\n        rx={task.barCornerRadius}\r\n        ry={task.barCornerRadius}\r\n        transform={transform}\r\n        className={styles.milestoneBackground}\r\n        onMouseDown={e => {\r\n          isDateChangeable && onEventStart(\"move\", task, e);\r\n        }}\r\n      />\r\n\r\n      <g className=\"handleGroup\">\r\n        {isRelationChangeable && (\r\n          <g>\r\n            {/* left */}\r\n            <BarRelationHandle\r\n              isRelationDrawMode={isRelationDrawMode}\r\n              x={task.x1 - relationCircleOffset}\r\n              y={task.y + taskHalfHeight}\r\n              radius={relationCircleRadius}\r\n              onMouseDown={() => {\r\n                onRelationStart(\"startOfTask\", task);\r\n              }}\r\n            />\r\n            {/* right */}\r\n            <BarRelationHandle\r\n              isRelationDrawMode={isRelationDrawMode}\r\n              x={task.x2 + relationCircleOffset}\r\n              y={task.y + taskHalfHeight}\r\n              radius={relationCircleRadius}\r\n              onMouseDown={() => {\r\n                onRelationStart(\"endOfTask\", task);\r\n              }}\r\n            />\r\n          </g>\r\n        )}\r\n      </g>\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./project.module.css\";\r\nimport { useProvideChipColors } from \"../../task-list/useProvideChipColors\";\r\nimport { HtmlTooltip } from \"../bar/bar\";\r\n\r\nexport const Project: React.FC<TaskItemProps> = ({ task /* isSelected */ }) => {\r\n  const { resolveChipColor, resolveChipLabelColor } = useProvideChipColors();\r\n  /* const barColor = isSelected\r\n    ? task.styles.backgroundSelectedColor\r\n    : task.styles.backgroundColor;\r\n  /*   const processColor = isSelected\r\n    ? task.styles.progressSelectedColor\r\n    : task.styles.progressColor; */\r\n  const projectWith = task.x2 - task.x1;\r\n\r\n  /*   const projectLeftTriangle = [\r\n    task.x1,\r\n    task.y + task.height / 2 - 1,\r\n    task.x1,\r\n    task.y + task.height,\r\n    task.x1 + 15,\r\n    task.y + task.height / 2 - 1,\r\n  ].join(\",\");\r\n  const projectRightTriangle = [\r\n    task.x2,\r\n    task.y + task.height / 2 - 1,\r\n    task.x2,\r\n    task.y + task.height,\r\n    task.x2 - 15,\r\n    task.y + task.height / 2 - 1,\r\n  ].join(\",\");\r\n */\r\n  return (\r\n    <HtmlTooltip\r\n      followCursor\r\n      title={\r\n        <React.Fragment>\r\n          <div style={{ margin: \"auto\" }}>\r\n            <div\r\n              style={{\r\n                background: resolveChipColor(task.color, \"Title chip\"),\r\n                color: resolveChipLabelColor(task.color, \"Title chip\"),\r\n                padding: \"0.5rem 1rem\",\r\n                borderRadius: \"50px\",\r\n                fontWeight: \"600\",\r\n                fontSize: \"12px\",\r\n                maxHeight: \"30px\",\r\n                lineHeight: 1,\r\n                maxWidth: \"235px\",\r\n                whiteSpace: \"nowrap\",\r\n                overflow: \"hidden\",\r\n                textOverflow: \"ellipsis\",\r\n                textAlign: \"center\",\r\n              }}\r\n            >\r\n              {task.name}\r\n            </div>\r\n          </div>\r\n          <pre\r\n            className={styles.tooltipDefaultContainerParagraph}\r\n          >{`${task.start.getDate()}.${\r\n            task.start.getMonth() + 1\r\n          }.${task.start.getFullYear()} - ${task.end.getDate()}.${\r\n            task.end.getMonth() + 1\r\n          }.${task.end.getFullYear()}`}</pre>\r\n          {task.end.getTime() - task.start.getTime() !== 0 && (\r\n            <p\r\n              className={styles.tooltipDefaultContainerParagraph}\r\n            >{`Duration: ${~~(\r\n              (task.end.getTime() - task.start.getTime()) /\r\n              (1000 * 60 * 60 * 24)\r\n            )} day(s)`}</p>\r\n          )}\r\n\r\n          <p className={styles.tooltipDefaultContainerParagraph}>\r\n            {!!task.progress && `Progress: ${task.progress} %`}\r\n          </p>\r\n        </React.Fragment>\r\n      }\r\n    >\r\n      <g tabIndex={0} className={styles.projectWrapper}>\r\n        <rect\r\n          fill={resolveChipColor(task.color, \"test\")} //COLOR OF !PROGRESS\r\n          x={task.x1}\r\n          width={projectWith}\r\n          y={task.y + 7}\r\n          height={5}\r\n          rx={task.barCornerRadius}\r\n          ry={task.barCornerRadius}\r\n          className={styles.projectBackground}\r\n        />\r\n        <rect\r\n          x={task.progressX}\r\n          width={task.progressWidth}\r\n          y={task.y + 7}\r\n          height={5}\r\n          ry={task.barCornerRadius}\r\n          rx={task.barCornerRadius}\r\n          fill={resolveChipLabelColor(task.color, \"test\")} //COLOR OF PROGRESS\r\n        />\r\n        {/* <rect\r\n        fill={barColor}\r\n        x={task.x1}\r\n        width={projectWith}\r\n        y={task.y}\r\n        height={task.height / 2}\r\n        rx={task.barCornerRadius}\r\n        ry={task.barCornerRadius}\r\n        className={styles.projectTop}\r\n      /> */}\r\n        {/* <polygon\r\n        className={styles.projectTop}\r\n        points={projectLeftTriangle}\r\n        fill={barColor}\r\n      />\r\n      <polygon\r\n        className={styles.projectTop}\r\n        points={projectRightTriangle}\r\n        fill={barColor}\r\n      /> */}\r\n      </g>\r\n    </HtmlTooltip>\r\n  );\r\n};\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport {\r\n  GanttContentMoveAction,\r\n  RelationMoveTarget,\r\n} from \"../../types/gantt-task-actions\";\r\nimport { Bar } from \"./bar/bar\";\r\nimport { Milestone } from \"./milestone/milestone\";\r\nimport { Project } from \"./project/project\";\r\nimport style from \"./task-list.module.css\";\r\n\r\nexport type TaskItemProps = {\r\n  task: BarTask;\r\n  arrowIndent: number;\r\n  taskHeight: number;\r\n  taskHalfHeight: number;\r\n  relationCircleOffset: number;\r\n  relationCircleRadius: number;\r\n  isProgressChangeable: boolean;\r\n  isDateChangeable: boolean;\r\n  isRelationChangeable: boolean;\r\n  isDelete: boolean;\r\n  isSelected: boolean;\r\n  isRelationDrawMode: boolean;\r\n  rtl: boolean;\r\n  onEventStart: (\r\n    action: GanttContentMoveAction,\r\n    selectedTask: BarTask,\r\n    event?: React.MouseEvent | React.KeyboardEvent\r\n  ) => any;\r\n  onRelationStart: (target: RelationMoveTarget, selectedTask: BarTask) => void;\r\n};\r\n\r\nexport const TaskItem: React.FC<TaskItemProps> = props => {\r\n  const {\r\n    task,\r\n    arrowIndent,\r\n    isDelete,\r\n    taskHeight,\r\n    isSelected,\r\n    isRelationDrawMode,\r\n    rtl,\r\n    onEventStart,\r\n  } = props;\r\n  const textRef = useRef<SVGTextElement>(null);\r\n  const [taskItem, setTaskItem] = useState<JSX.Element>(<div />);\r\n  const [isTextInside, setIsTextInside] = useState(true);\r\n\r\n  useEffect(() => {\r\n    switch (task.typeInternal) {\r\n      case \"milestone\":\r\n        setTaskItem(<Milestone {...props} />);\r\n        break;\r\n      case \"project\":\r\n        setTaskItem(<Project {...props} />);\r\n        break;\r\n      /* case \"smalltask\":\r\n        setTaskItem(<BarSmall {...props} />);\r\n        break; */\r\n      default:\r\n        setTaskItem(<Bar {...props} />);\r\n        break;\r\n    }\r\n  }, [task, isSelected, isRelationDrawMode, props]);\r\n\r\n  useEffect(() => {\r\n    if (textRef.current) {\r\n      setIsTextInside(textRef.current.getBBox().width < task.x2 - task.x1);\r\n    }\r\n  }, [textRef, task]);\r\n\r\n  const getX = () => {\r\n    const width = task.x2 - task.x1;\r\n    const hasChild = task.barChildren.length > 0;\r\n    if (isTextInside) {\r\n      return task.x1 + width * 0.5;\r\n    }\r\n    if (rtl && textRef.current) {\r\n      return (\r\n        task.x1 -\r\n        textRef.current.getBBox().width -\r\n        arrowIndent * +hasChild -\r\n        arrowIndent * 0.2\r\n      );\r\n    } else {\r\n      return task.x1 + width + arrowIndent * +hasChild + arrowIndent * 0.2;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <g\r\n      onKeyDown={e => {\r\n        switch (e.key) {\r\n          case \"Delete\": {\r\n            if (isDelete) onEventStart(\"delete\", task, e);\r\n            break;\r\n          }\r\n        }\r\n        e.stopPropagation();\r\n      }}\r\n      onMouseEnter={e => {\r\n        onEventStart(\"mouseenter\", task, e);\r\n      }}\r\n      onMouseLeave={e => {\r\n        onEventStart(\"mouseleave\", task, e);\r\n      }}\r\n      onDoubleClick={e => {\r\n        onEventStart(\"dblclick\", task, e);\r\n      }}\r\n      onClick={e => {\r\n        onEventStart(\"click\", task, e);\r\n      }}\r\n      onFocus={() => {\r\n        onEventStart(\"select\", task);\r\n      }}\r\n    >\r\n      {taskItem}\r\n      <text\r\n        x={getX()}\r\n        y={task.y + taskHeight * 0.5}\r\n        className={\r\n          isTextInside\r\n            ? style.barLabel\r\n            : style.barLabel && style.barLabelOutside\r\n        }\r\n        ref={textRef}\r\n      >\r\n        {/* {task.name} */}\r\n      </text>\r\n    </g>\r\n  );\r\n};\r\n","import React, { useCallback, useEffect, useState } from \"react\";\r\nimport { EventOption } from \"../../types/public-types\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport { Arrow } from \"../other/arrow\";\r\nimport { RelationLine } from \"../other/relation-line\";\r\nimport { getRelationCircleByCoordinates } from \"../../helpers/get-relation-circle-by-coordinates\";\r\nimport { handleTaskBySVGMouseEvent } from \"../../helpers/bar-helper\";\r\nimport { isKeyboardEvent } from \"../../helpers/other-helper\";\r\nimport { TaskItem } from \"../task-item/task-item\";\r\nimport {\r\n  BarMoveAction,\r\n  GanttContentMoveAction,\r\n  GanttEvent,\r\n  GanttRelationEvent,\r\n  RelationMoveTarget,\r\n} from \"../../types/gantt-task-actions\";\r\n\r\nexport type TaskGanttContentProps = {\r\n  tasks: BarTask[];\r\n  dates: Date[];\r\n  ganttEvent: GanttEvent;\r\n  ganttRelationEvent: GanttRelationEvent | null;\r\n  selectedTask: BarTask | undefined;\r\n  rowHeight: number;\r\n  columnWidth: number;\r\n  timeStep: number;\r\n  svg?: React.RefObject<SVGSVGElement>;\r\n  svgWidth: number;\r\n  taskHeight: number;\r\n  taskHalfHeight: number;\r\n  relationCircleOffset: number;\r\n  relationCircleRadius: number;\r\n  arrowColor: string;\r\n  arrowIndent: number;\r\n  fontSize: string;\r\n  fontFamily: string;\r\n  rtl: boolean;\r\n  setGanttEvent: (value: GanttEvent) => void;\r\n  setGanttRelationEvent: React.Dispatch<\r\n    React.SetStateAction<GanttRelationEvent | null>\r\n  >;\r\n  setFailedTask: (value: BarTask | null) => void;\r\n  setSelectedTask: (taskId: string) => void;\r\n} & EventOption;\r\n\r\nexport const TaskGanttContent: React.FC<TaskGanttContentProps> = ({\r\n  tasks,\r\n  dates,\r\n  ganttEvent,\r\n  ganttRelationEvent,\r\n  selectedTask,\r\n  rowHeight,\r\n  columnWidth,\r\n  timeStep,\r\n  svg,\r\n  taskHeight,\r\n  taskHalfHeight,\r\n  relationCircleOffset,\r\n  relationCircleRadius,\r\n  arrowColor,\r\n  arrowIndent,\r\n  fontFamily,\r\n  fontSize,\r\n  rtl,\r\n  setGanttEvent,\r\n  setGanttRelationEvent,\r\n  setFailedTask,\r\n  setSelectedTask,\r\n  onDateChange,\r\n  onRelationChange,\r\n  onProgressChange,\r\n  onDoubleClick,\r\n  onClick,\r\n  onDelete,\r\n}) => {\r\n  const point = svg?.current?.createSVGPoint();\r\n  const [xStep, setXStep] = useState(0);\r\n  const [initEventX1Delta, setInitEventX1Delta] = useState(0);\r\n  const [isMoving, setIsMoving] = useState(false);\r\n\r\n  /* const allBarChildren: BarTask[] = getAllBarChildren(ganttEvent.changedTask);\r\n  console.log(allBarChildren); */\r\n  // create xStep\r\n  useEffect(() => {\r\n    const dateDelta =\r\n      dates[1].getTime() -\r\n      dates[0].getTime() -\r\n      dates[1].getTimezoneOffset() * 60 * 1000 +\r\n      dates[0].getTimezoneOffset() * 60 * 1000;\r\n    const newXStep = (timeStep * columnWidth) / dateDelta;\r\n    setXStep(newXStep);\r\n  }, [columnWidth, dates, timeStep]);\r\n\r\n  useEffect(() => {\r\n    const handleMouseMove = async (event: MouseEvent) => {\r\n      if (!ganttEvent.changedTask || !point || !svg?.current) return;\r\n      event.preventDefault();\r\n\r\n      point.x = event.clientX;\r\n      const cursor = point.matrixTransform(\r\n        svg?.current.getScreenCTM()?.inverse()\r\n      );\r\n      console.log(\"TASKS:\", tasks);\r\n      const { isChanged, changedTask, changedTasks } =\r\n        handleTaskBySVGMouseEvent(\r\n          cursor.x,\r\n          ganttEvent.action as BarMoveAction,\r\n          ganttEvent.changedTask,\r\n          tasks,\r\n          xStep,\r\n          timeStep,\r\n          initEventX1Delta,\r\n          rtl\r\n        );\r\n      if (isChanged) {\r\n        console.log(\"CHT\", changedTask);\r\n        setGanttEvent({ action: ganttEvent.action, changedTask, changedTasks });\r\n      }\r\n    };\r\n\r\n    const handleMouseUp = async (event: MouseEvent) => {\r\n      const { action, originalSelectedTask, changedTask } = ganttEvent;\r\n      if (!changedTask || !point || !svg?.current || !originalSelectedTask)\r\n        return;\r\n      event.preventDefault();\r\n\r\n      point.x = event.clientX;\r\n      const cursor = point.matrixTransform(\r\n        svg?.current.getScreenCTM()?.inverse()\r\n      );\r\n\r\n      /* changedTask.prevStart = tasks.find(\r\n        task => task.id === changedTask.id\r\n      )?.start;\r\n      changedTask.prevEnd = tasks.find(task => task.id === changedTask.id)?.end; */\r\n\r\n      const { changedTask: newChangedTask, changedTasks } =\r\n        handleTaskBySVGMouseEvent(\r\n          cursor.x,\r\n          action as BarMoveAction,\r\n          changedTask,\r\n          tasks,\r\n          xStep,\r\n          timeStep,\r\n          initEventX1Delta,\r\n          rtl\r\n        );\r\n\r\n      const isNotLikeOriginal =\r\n        originalSelectedTask.start !== newChangedTask.start ||\r\n        originalSelectedTask.prevEnd !== newChangedTask.end ||\r\n        originalSelectedTask.progress !== newChangedTask.progress;\r\n\r\n      // remove listeners\r\n      svg.current.removeEventListener(\"mousemove\", handleMouseMove);\r\n      svg.current.removeEventListener(\"mouseup\", handleMouseUp);\r\n      setGanttEvent({ action: \"\" });\r\n      setIsMoving(false);\r\n      console.log(\"NCT\", newChangedTask);\r\n      // custom operation start\r\n      let operationSuccess = true;\r\n      console.log(\r\n        \"CONDITION\",\r\n        originalSelectedTask.start,\r\n        newChangedTask.start\r\n      );\r\n      if (\r\n        (action === \"move\" || action === \"end\" || action === \"start\") &&\r\n        onDateChange &&\r\n        isNotLikeOriginal\r\n      ) {\r\n        try {\r\n          console.log(\"CODE0\", newChangedTask);\r\n          const result = await onDateChange(\r\n            newChangedTask,\r\n            newChangedTask.barChildren,\r\n            changedTasks\r\n          );\r\n          console.log(\"RESULT CONTENT\", result);\r\n          if (result !== undefined) {\r\n            console.log(\"SUCCESS\");\r\n            operationSuccess = result;\r\n          }\r\n        } catch (error) {\r\n          console.log(\"ERROR\");\r\n          operationSuccess = false;\r\n        }\r\n      } else if (onProgressChange && isNotLikeOriginal) {\r\n        try {\r\n          const result = await onProgressChange(\r\n            newChangedTask,\r\n            newChangedTask.barChildren\r\n          );\r\n          if (result !== undefined) {\r\n            operationSuccess = result;\r\n          }\r\n        } catch (error) {\r\n          operationSuccess = false;\r\n        }\r\n      }\r\n\r\n      // If operation is failed - return old state\r\n      if (!operationSuccess) {\r\n        setFailedTask(originalSelectedTask);\r\n      }\r\n    };\r\n\r\n    if (\r\n      !isMoving &&\r\n      (ganttEvent.action === \"move\" ||\r\n        ganttEvent.action === \"end\" ||\r\n        ganttEvent.action === \"start\" ||\r\n        ganttEvent.action === \"progress\") &&\r\n      svg?.current\r\n    ) {\r\n      svg.current.addEventListener(\"mousemove\", handleMouseMove);\r\n      svg.current.addEventListener(\"mouseup\", handleMouseUp);\r\n\r\n      setIsMoving(true);\r\n    }\r\n  }, [\r\n    ganttEvent,\r\n    xStep,\r\n    initEventX1Delta,\r\n    onProgressChange,\r\n    timeStep,\r\n    onDateChange,\r\n    svg,\r\n    isMoving,\r\n    point,\r\n    rtl,\r\n    setFailedTask,\r\n    setGanttEvent,\r\n    tasks,\r\n  ]);\r\n\r\n  const startRelationTarget = ganttRelationEvent?.target;\r\n  const startRelationTask = ganttRelationEvent?.task;\r\n\r\n  /**\r\n   * Drag arrow\r\n   */\r\n  useEffect(() => {\r\n    if (!onRelationChange || !startRelationTarget || !startRelationTask) {\r\n      return undefined;\r\n    }\r\n\r\n    const svgNode = svg?.current;\r\n\r\n    if (!svgNode) {\r\n      return undefined;\r\n    }\r\n\r\n    if (!point) {\r\n      return undefined;\r\n    }\r\n\r\n    const handleMouseMove = (event: MouseEvent) => {\r\n      const { clientX, clientY } = event;\r\n\r\n      point.x = clientX;\r\n      point.y = clientY;\r\n\r\n      const ctm = svgNode.getScreenCTM();\r\n\r\n      if (!ctm) {\r\n        return;\r\n      }\r\n\r\n      const svgP = point.matrixTransform(ctm.inverse());\r\n\r\n      setGanttRelationEvent(prevValue => {\r\n        if (!prevValue) {\r\n          return null;\r\n        }\r\n\r\n        return {\r\n          ...prevValue,\r\n          endX: svgP.x,\r\n          endY: svgP.y,\r\n        };\r\n      });\r\n    };\r\n\r\n    const handleMouseUp = (event: MouseEvent) => {\r\n      const { clientX, clientY } = event;\r\n\r\n      point.x = clientX;\r\n      point.y = clientY;\r\n\r\n      const ctm = svgNode.getScreenCTM();\r\n\r\n      if (!ctm) {\r\n        return;\r\n      }\r\n\r\n      const svgP = point.matrixTransform(ctm.inverse());\r\n\r\n      const endTargetRelationCircle = getRelationCircleByCoordinates(\r\n        svgP,\r\n        tasks,\r\n        taskHalfHeight,\r\n        relationCircleOffset,\r\n        relationCircleRadius,\r\n        rtl\r\n      );\r\n\r\n      if (endTargetRelationCircle) {\r\n        onRelationChange(\r\n          [startRelationTask, startRelationTarget],\r\n          endTargetRelationCircle\r\n        );\r\n      }\r\n\r\n      setGanttRelationEvent(null);\r\n    };\r\n\r\n    svgNode.addEventListener(\"mousemove\", handleMouseMove);\r\n    svgNode.addEventListener(\"mouseup\", handleMouseUp);\r\n\r\n    return () => {\r\n      svgNode.removeEventListener(\"mousemove\", handleMouseMove);\r\n      svgNode.removeEventListener(\"mouseup\", handleMouseUp);\r\n    };\r\n  }, [\r\n    svg,\r\n    rtl,\r\n    point,\r\n    startRelationTarget,\r\n    startRelationTask,\r\n    setGanttRelationEvent,\r\n    tasks,\r\n    taskHalfHeight,\r\n    relationCircleOffset,\r\n    relationCircleRadius,\r\n    onRelationChange,\r\n  ]);\r\n\r\n  /**\r\n   * Method is Start point of task change\r\n   */\r\n  const handleBarEventStart = async (\r\n    action: GanttContentMoveAction,\r\n    task: BarTask,\r\n    event?: React.MouseEvent | React.KeyboardEvent\r\n  ) => {\r\n    if (!event) {\r\n      if (action === \"select\") {\r\n        setSelectedTask(task.id);\r\n      }\r\n    }\r\n    // Keyboard events\r\n    else if (isKeyboardEvent(event)) {\r\n      if (action === \"delete\") {\r\n        if (onDelete) {\r\n          try {\r\n            const result = await onDelete(task);\r\n            if (result !== undefined && result) {\r\n              setGanttEvent({ action, changedTask: task });\r\n            }\r\n          } catch (error) {\r\n            console.error(\"Error on Delete. \" + error);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // Mouse Events\r\n    else if (action === \"mouseenter\") {\r\n      if (!ganttEvent.action) {\r\n        setGanttEvent({\r\n          action,\r\n          changedTask: task,\r\n          originalSelectedTask: task,\r\n        });\r\n      }\r\n    } else if (action === \"mouseleave\") {\r\n      if (ganttEvent.action === \"mouseenter\") {\r\n        setGanttEvent({ action: \"\" });\r\n      }\r\n    } else if (action === \"dblclick\") {\r\n      !!onDoubleClick && onDoubleClick(task);\r\n    } else if (action === \"click\") {\r\n      !!onClick && onClick(task);\r\n    }\r\n    // Change task event start\r\n    else if (action === \"move\") {\r\n      if (!svg?.current || !point) return;\r\n      point.x = event.clientX;\r\n      const cursor = point.matrixTransform(\r\n        svg.current.getScreenCTM()?.inverse()\r\n      );\r\n      setInitEventX1Delta(cursor.x - task.x1);\r\n      setGanttEvent({\r\n        action,\r\n        changedTask: task,\r\n        originalSelectedTask: task,\r\n      });\r\n      console.log(task);\r\n      console.log(tasks);\r\n    } else {\r\n      setGanttEvent({\r\n        action,\r\n        changedTask: task,\r\n        originalSelectedTask: task,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleBarRelationStart = useCallback(\r\n    (target: RelationMoveTarget, task: BarTask) => {\r\n      const startX =\r\n        (target === \"startOfTask\") !== rtl ? task.x1 - 10 : task.x2 + 10;\r\n      const startY = task.y + Math.round(task.height / 2);\r\n\r\n      setGanttRelationEvent({\r\n        target,\r\n        task,\r\n        startX,\r\n        startY,\r\n        endX: startX,\r\n        endY: startY,\r\n      });\r\n    },\r\n    [setGanttRelationEvent, rtl]\r\n  );\r\n\r\n  return (\r\n    <g className=\"content\">\r\n      <g className=\"arrows\" fill={arrowColor} stroke={arrowColor}>\r\n        {tasks.map(task => {\r\n          return task.barChildren.map(child => {\r\n            return (\r\n              <Arrow\r\n                key={`Arrow from ${task.id} to ${tasks[child.index].id}`}\r\n                taskFrom={task}\r\n                taskTo={tasks[child.index]}\r\n                rowHeight={rowHeight}\r\n                taskHeight={taskHeight}\r\n                arrowIndent={arrowIndent}\r\n                rtl={rtl}\r\n              />\r\n            );\r\n          });\r\n        })}\r\n      </g>\r\n      <g className=\"bar\" fontFamily={fontFamily} fontSize={fontSize}>\r\n        {tasks.map(task => {\r\n          return (\r\n            <TaskItem\r\n              task={task}\r\n              arrowIndent={arrowIndent}\r\n              taskHeight={taskHeight}\r\n              taskHalfHeight={taskHalfHeight}\r\n              relationCircleOffset={relationCircleOffset}\r\n              relationCircleRadius={relationCircleRadius}\r\n              isRelationDrawMode={Boolean(ganttRelationEvent)}\r\n              isProgressChangeable={!!onProgressChange && !task.isDisabled}\r\n              isDateChangeable={!!onDateChange && !task.isDisabled}\r\n              isRelationChangeable={!!onRelationChange && !task.isDisabled}\r\n              isDelete={!task.isDisabled}\r\n              onEventStart={handleBarEventStart}\r\n              onRelationStart={handleBarRelationStart}\r\n              key={task.id}\r\n              isSelected={!!selectedTask && task.id === selectedTask.id}\r\n              rtl={rtl}\r\n            />\r\n          );\r\n        })}\r\n      </g>\r\n      {ganttRelationEvent && (\r\n        <RelationLine\r\n          x1={ganttRelationEvent.startX}\r\n          x2={ganttRelationEvent.endX}\r\n          y1={ganttRelationEvent.startY}\r\n          y2={ganttRelationEvent.endY}\r\n        />\r\n      )}\r\n    </g>\r\n  );\r\n};\r\n\r\n/* function getAllBarChildren(obj: BarTask | undefined) {\r\n  let barChildrenList: BarTask[] = [];\r\n\r\n  if (obj && obj.barChildren && obj.barChildren.length > 0) {\r\n    barChildrenList = barChildrenList.concat(obj.barChildren);\r\n    obj.barChildren.forEach(child => {\r\n      barChildrenList = barChildrenList.concat(getAllBarChildren(child));\r\n    });\r\n  }\r\n\r\n  return barChildrenList;\r\n} */\r\n","import React, { useRef, useEffect } from \"react\";\r\nimport { GridProps, Grid } from \"../grid/grid\";\r\nimport { CalendarProps, Calendar } from \"../calendar/calendar\";\r\nimport { TaskGanttContentProps, TaskGanttContent } from \"./task-gantt-content\";\r\nimport styles from \"./gantt.module.css\";\r\n\r\nexport type TaskGanttProps = {\r\n  gridProps: GridProps;\r\n  calendarProps: CalendarProps;\r\n  barProps: TaskGanttContentProps;\r\n  ganttHeight: number;\r\n  scrollY: number;\r\n  scrollX: number;\r\n};\r\nexport const TaskGantt: React.FC<TaskGanttProps> = ({\r\n  gridProps,\r\n  calendarProps,\r\n  barProps,\r\n  ganttHeight,\r\n  scrollY,\r\n  scrollX,\r\n}) => {\r\n  const ganttSVGRef = useRef<SVGSVGElement>(null);\r\n  const horizontalContainerRef = useRef<HTMLDivElement>(null);\r\n  const verticalGanttContainerRef = useRef<HTMLDivElement>(null);\r\n  const newBarProps = { ...barProps, svg: ganttSVGRef };\r\n\r\n  useEffect(() => {\r\n    if (horizontalContainerRef.current) {\r\n      horizontalContainerRef.current.scrollTop = scrollY;\r\n    }\r\n  }, [scrollY]);\r\n\r\n  useEffect(() => {\r\n    if (verticalGanttContainerRef.current) {\r\n      verticalGanttContainerRef.current.scrollLeft = scrollX;\r\n    }\r\n  }, [scrollX]);\r\n\r\n  return (\r\n    <div\r\n      className={styles.ganttVerticalContainerChanged}\r\n      ref={verticalGanttContainerRef}\r\n      dir=\"ltr\"\r\n    >\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width={gridProps.svgWidth}\r\n        height={calendarProps.headerHeight}\r\n        fontFamily={barProps.fontFamily}\r\n      >\r\n        <Calendar {...calendarProps} />\r\n      </svg>\r\n      <div\r\n        ref={horizontalContainerRef}\r\n        className={styles.horizontalContainer}\r\n        style={\r\n          ganttHeight\r\n            ? { height: ganttHeight, width: gridProps.svgWidth }\r\n            : { width: gridProps.svgWidth }\r\n        }\r\n      >\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          width={gridProps.svgWidth}\r\n          height={barProps.rowHeight * barProps.tasks.length}\r\n          fontFamily={barProps.fontFamily}\r\n          ref={ganttSVGRef}\r\n        >\r\n          <Grid {...gridProps} />\r\n          <TaskGanttContent {...newBarProps} />\r\n        </svg>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, {\r\n  useState,\r\n  SyntheticEvent,\r\n  useRef,\r\n  useEffect,\r\n  useMemo,\r\n} from \"react\";\r\nimport { ViewMode, GanttProps, Task } from \"../../types/public-types\";\r\nimport { GridProps } from \"../grid/grid\";\r\nimport { ganttDateRange, seedDates } from \"../../helpers/date-helper\";\r\nimport { CalendarProps } from \"../calendar/calendar\";\r\nimport { TaskGanttContentProps } from \"./task-gantt-content\";\r\nimport { TaskListHeaderDefault } from \"../task-list/task-list-header\";\r\nimport { TaskListTableDefault } from \"../task-list/task-list-table\";\r\n/* import { StandardTooltipContent  Tooltip } from \"../other/tooltip\"; */\r\nimport { VerticalScroll } from \"../other/vertical-scroll\";\r\nimport { TaskListProps, TaskList } from \"../task-list/task-list\";\r\nimport { TaskGantt } from \"./task-gantt\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport { convertToBarTasks } from \"../../helpers/bar-helper\";\r\nimport { GanttEvent, GanttRelationEvent } from \"../../types/gantt-task-actions\";\r\nimport { DateSetup } from \"../../types/date-setup\";\r\n/* import { HorizontalScroll } from \"../other/horizontal-scroll\"; */\r\nimport { removeHiddenTasks, sortTasks } from \"../../helpers/other-helper\";\r\nimport styles from \"./gantt.module.css\";\r\n/* import { HorizontalScroll } from \"../other/horizontal-scroll\"; */\r\n\r\nexport const Gantt: React.FunctionComponent<GanttProps> = ({\r\n  tasks,\r\n  headerHeight = 50,\r\n  columnWidth = 60,\r\n  listCellWidth = \"155px\",\r\n  rowHeight = 50,\r\n  relationCircleOffset = 10,\r\n  relationCircleRadius = 5,\r\n  ganttHeight = 0,\r\n  viewMode = ViewMode.Day,\r\n  preStepsCount = 1,\r\n  locale = \"en-GB\",\r\n  barFill = 60,\r\n  barCornerRadius = 3,\r\n  barProgressColor = \"#a3a3ff\",\r\n  barProgressSelectedColor = \"#8282f5\",\r\n  barBackgroundColor = \"#b8c2cc\",\r\n  barBackgroundSelectedColor = \"#aeb8c2\",\r\n  projectProgressColor = \"#7db59a\",\r\n  projectProgressSelectedColor = \"#59a985\",\r\n  projectBackgroundColor = \"#fac465\",\r\n  projectBackgroundSelectedColor = \"#f7bb53\",\r\n  milestoneBackgroundColor = \"#f1c453\",\r\n  milestoneBackgroundSelectedColor = \"#f29e4c\",\r\n  rtl = false,\r\n  handleWidth = 8,\r\n  timeStep = 300000,\r\n  arrowColor = \"grey\",\r\n  fontFamily = \"Arial, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue\",\r\n  fontSize = \"14px\",\r\n  arrowIndent = 20,\r\n  todayColor = \"rgba(252, 248, 227, 0.5)\",\r\n  viewDate,\r\n  /*   TooltipContent = StandardTooltipContent, */\r\n  TaskListHeader = TaskListHeaderDefault,\r\n  TaskListTable = TaskListTableDefault,\r\n  onDateChange,\r\n  onRelationChange,\r\n  onProgressChange,\r\n  onDoubleClick,\r\n  onClick,\r\n  onDelete,\r\n  onSelect,\r\n  onExpanderClick,\r\n}) => {\r\n  const wrapperRef = useRef<HTMLDivElement>(null);\r\n  const taskListRef = useRef<HTMLDivElement>(null);\r\n  const [dateSetup, setDateSetup] = useState<DateSetup>(() => {\r\n    const [startDate, endDate] = ganttDateRange(tasks, viewMode, preStepsCount);\r\n    return { viewMode, dates: seedDates(startDate, endDate, viewMode) };\r\n  });\r\n  const [currentViewDate, setCurrentViewDate] = useState<Date | undefined>(\r\n    undefined\r\n  );\r\n\r\n  /*   const [taskListWidth, setTaskListWidth] = useState(0); */\r\n  /*   const [svgContainerWidth, setSvgContainerWidth] = useState(0);\r\n  const [svgContainerHeight, setSvgContainerHeight] = useState(ganttHeight); */\r\n  const [barTasks, setBarTasks] = useState<BarTask[]>([]);\r\n  const [ganttEvent, setGanttEvent] = useState<GanttEvent>({\r\n    action: \"\",\r\n  });\r\n\r\n  const [ganttRelationEvent, setGanttRelationEvent] =\r\n    useState<GanttRelationEvent | null>(null);\r\n\r\n  const taskHeight = useMemo(\r\n    () => (rowHeight * barFill) / 100,\r\n    [rowHeight, barFill]\r\n  );\r\n\r\n  const taskHalfHeight = useMemo(\r\n    () => Math.round(taskHeight / 2),\r\n    [taskHeight]\r\n  );\r\n\r\n  const [selectedTask, setSelectedTask] = useState<BarTask>();\r\n  const [failedTask, setFailedTask] = useState<BarTask | null>(null);\r\n\r\n  const svgWidth = dateSetup.dates.length * columnWidth;\r\n  const ganttFullHeight = barTasks.length * rowHeight;\r\n\r\n  const [scrollY, setScrollY] = useState(0);\r\n  const [scrollX, setScrollX] = useState(-1);\r\n  const [ignoreScrollEvent, setIgnoreScrollEvent] = useState(false);\r\n\r\n  // task change events\r\n  useEffect(() => {\r\n    let filteredTasks: Task[];\r\n    if (onExpanderClick) {\r\n      filteredTasks = removeHiddenTasks(tasks);\r\n    } else {\r\n      filteredTasks = tasks;\r\n    }\r\n    filteredTasks = filteredTasks.sort(sortTasks);\r\n    const [startDate, endDate] = ganttDateRange(\r\n      filteredTasks,\r\n      viewMode,\r\n      preStepsCount\r\n    );\r\n    let newDates = seedDates(startDate, endDate, viewMode);\r\n    if (rtl) {\r\n      newDates = newDates.reverse();\r\n      if (scrollX === -1) {\r\n        setScrollX(newDates.length * columnWidth);\r\n      }\r\n    }\r\n    setDateSetup({ dates: newDates, viewMode });\r\n    setBarTasks(\r\n      convertToBarTasks(\r\n        filteredTasks,\r\n        newDates,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        rtl,\r\n        barProgressColor,\r\n        barProgressSelectedColor,\r\n        barBackgroundColor,\r\n        barBackgroundSelectedColor,\r\n        projectProgressColor,\r\n        projectProgressSelectedColor,\r\n        projectBackgroundColor,\r\n        projectBackgroundSelectedColor,\r\n        milestoneBackgroundColor,\r\n        milestoneBackgroundSelectedColor\r\n      )\r\n    );\r\n  }, [\r\n    tasks,\r\n    viewMode,\r\n    preStepsCount,\r\n    rowHeight,\r\n    barCornerRadius,\r\n    columnWidth,\r\n    taskHeight,\r\n    handleWidth,\r\n    barProgressColor,\r\n    barProgressSelectedColor,\r\n    barBackgroundColor,\r\n    barBackgroundSelectedColor,\r\n    projectProgressColor,\r\n    projectProgressSelectedColor,\r\n    projectBackgroundColor,\r\n    projectBackgroundSelectedColor,\r\n    milestoneBackgroundColor,\r\n    milestoneBackgroundSelectedColor,\r\n    rtl,\r\n    onExpanderClick,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (\r\n      viewMode === dateSetup.viewMode &&\r\n      ((viewDate && !currentViewDate) ||\r\n        (viewDate && currentViewDate?.valueOf() !== viewDate.valueOf()))\r\n    ) {\r\n      const dates = dateSetup.dates;\r\n      const index = dates.findIndex(\r\n        (d, i) =>\r\n          viewDate.valueOf() >= d.valueOf() &&\r\n          i + 1 !== dates.length &&\r\n          viewDate.valueOf() < dates[i + 1].valueOf()\r\n      );\r\n      if (index === -1) {\r\n        return;\r\n      }\r\n      setCurrentViewDate(viewDate);\r\n      setScrollX(columnWidth * index);\r\n    }\r\n  }, [\r\n    viewDate,\r\n    columnWidth,\r\n    dateSetup.dates,\r\n    dateSetup.viewMode,\r\n    viewMode,\r\n    currentViewDate,\r\n    setCurrentViewDate,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const { changedTask, action, changedTasks } = ganttEvent;\r\n    if (changedTask) {\r\n      if (action === \"delete\") {\r\n        setGanttEvent({ action: \"\" });\r\n\r\n        setBarTasks(barTasks.filter(t => t.id !== changedTask.id));\r\n      } else if (\r\n        action === \"move\" ||\r\n        action === \"end\" ||\r\n        action === \"start\" ||\r\n        action === \"progress\"\r\n      ) {\r\n        const prevStateTask = barTasks.find(t => t.id === changedTask.id);\r\n        if (\r\n          prevStateTask &&\r\n          (prevStateTask.start.getTime() !== changedTask.start.getTime() ||\r\n            prevStateTask.end.getTime() !== changedTask.end.getTime() ||\r\n            prevStateTask.progress !== changedTask.progress)\r\n        ) {\r\n          console.log(\"CHANGED TASKS\", changedTasks);\r\n\r\n          if (\r\n            changedTasks?.length !== 0 &&\r\n            changedTasks?.length !== undefined\r\n          ) {\r\n            console.log(\"CHANGED TASKSTEST\", changedTasks);\r\n\r\n            const mergedArray = barTasks.map(barTask => {\r\n              const changedItem = changedTasks.find(\r\n                item => item.id === barTask.id\r\n              );\r\n              console.log(\"CHITM\", changedItem);\r\n              if (changedItem) {\r\n                console.log({\r\n                  ...barTask,\r\n                  ...changedItem,\r\n                  //offset: changedItem.x1 - barTasks[1].x1,\r\n                });\r\n                return {\r\n                  ...barTask,\r\n                  ...changedItem,\r\n                  //offset: changedItem.x1 - barTasks[1].x1,\r\n                };\r\n              } else {\r\n                return barTask;\r\n              }\r\n            });\r\n            setBarTasks(mergedArray);\r\n            //setBarTasks(changedTasks);\r\n            console.log(\"BAR TASKS\", mergedArray);\r\n          } else {\r\n            const newTaskList = barTasks.map(t =>\r\n              t.id === changedTask.id ? changedTask : t\r\n            );\r\n            setBarTasks(newTaskList);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }, [barTasks, ganttEvent]);\r\n\r\n  useEffect(() => {\r\n    if (failedTask) {\r\n      setBarTasks(barTasks.map(t => (t.id !== failedTask.id ? t : failedTask)));\r\n      setFailedTask(null);\r\n    }\r\n  }, [failedTask, barTasks]);\r\n\r\n  /*   useEffect(() => {\r\n    if (!listCellWidth) {\r\n      setTaskListWidth(0);\r\n    }\r\n    if (taskListRef.current) {\r\n      setTaskListWidth(taskListRef.current.offsetWidth);\r\n    }\r\n  }, [taskListRef, listCellWidth]); */\r\n\r\n  /*   useEffect(() => {\r\n    if (wrapperRef.current) {\r\n      setSvgContainerWidth(wrapperRef.current.offsetWidth - taskListWidth);\r\n    }\r\n  }, [wrapperRef, taskListWidth]);\r\n\r\n  useEffect(() => {\r\n    if (ganttHeight) {\r\n      setSvgContainerHeight(ganttHeight + headerHeight);\r\n    } else {\r\n      setSvgContainerHeight(tasks.length * rowHeight + headerHeight);\r\n    }\r\n  }, [ganttHeight, tasks, headerHeight, rowHeight]); */\r\n\r\n  // scroll events\r\n  useEffect(() => {\r\n    const handleWheel = (event: WheelEvent) => {\r\n      if (event.shiftKey || event.deltaX) {\r\n        const scrollMove = event.deltaX ? event.deltaX : event.deltaY;\r\n        let newScrollX = scrollX + scrollMove;\r\n        if (newScrollX < 0) {\r\n          newScrollX = 0;\r\n        } else if (newScrollX > svgWidth) {\r\n          newScrollX = svgWidth;\r\n        }\r\n        setScrollX(newScrollX);\r\n        event.preventDefault();\r\n      } else if (ganttHeight) {\r\n        let newScrollY = scrollY + event.deltaY;\r\n        if (newScrollY < 0) {\r\n          newScrollY = 0;\r\n        } else if (newScrollY > ganttFullHeight - ganttHeight) {\r\n          newScrollY = ganttFullHeight - ganttHeight;\r\n        }\r\n        if (newScrollY !== scrollY) {\r\n          setScrollY(newScrollY);\r\n          event.preventDefault();\r\n        }\r\n      }\r\n\r\n      setIgnoreScrollEvent(true);\r\n    };\r\n\r\n    // subscribe if scroll is necessary\r\n    wrapperRef.current?.addEventListener(\"wheel\", handleWheel, {\r\n      passive: false,\r\n    });\r\n    return () => {\r\n      wrapperRef.current?.removeEventListener(\"wheel\", handleWheel);\r\n    };\r\n  }, [\r\n    wrapperRef,\r\n    scrollY,\r\n    scrollX,\r\n    ganttHeight,\r\n    svgWidth,\r\n    rtl,\r\n    ganttFullHeight,\r\n  ]);\r\n\r\n  const handleScrollY = (event: SyntheticEvent<HTMLDivElement>) => {\r\n    if (scrollY !== event.currentTarget.scrollTop && !ignoreScrollEvent) {\r\n      setScrollY(event.currentTarget.scrollTop);\r\n      setIgnoreScrollEvent(true);\r\n    } else {\r\n      setIgnoreScrollEvent(false);\r\n    }\r\n  };\r\n\r\n  /*    const handleScrollX = (event: SyntheticEvent<HTMLDivElement>) => {\r\n    if (scrollX !== event.currentTarget.scrollLeft && !ignoreScrollEvent) {\r\n      setScrollX(event.currentTarget.scrollLeft);\r\n      setIgnoreScrollEvent(true);\r\n    } else {\r\n      setIgnoreScrollEvent(false);\r\n    }\r\n  };  */\r\n\r\n  /**\r\n   * Handles arrow keys events and transform it to new scroll\r\n   */\r\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLDivElement>) => {\r\n    event.preventDefault();\r\n    let newScrollY = scrollY;\r\n    let newScrollX = scrollX;\r\n    let isX = true;\r\n    switch (event.key) {\r\n      case \"Down\": // IE/Edge specific value\r\n      case \"ArrowDown\":\r\n        newScrollY += rowHeight;\r\n        isX = false;\r\n        break;\r\n      case \"Up\": // IE/Edge specific value\r\n      case \"ArrowUp\":\r\n        newScrollY -= rowHeight;\r\n        isX = false;\r\n        break;\r\n      case \"Left\":\r\n      case \"ArrowLeft\":\r\n        newScrollX -= columnWidth;\r\n        break;\r\n      case \"Right\": // IE/Edge specific value\r\n      case \"ArrowRight\":\r\n        newScrollX += columnWidth;\r\n        break;\r\n    }\r\n    if (isX) {\r\n      if (newScrollX < 0) {\r\n        newScrollX = 0;\r\n      } else if (newScrollX > svgWidth) {\r\n        newScrollX = svgWidth;\r\n      }\r\n      setScrollX(newScrollX);\r\n    } else {\r\n      if (newScrollY < 0) {\r\n        newScrollY = 0;\r\n      } else if (newScrollY > ganttFullHeight - ganttHeight) {\r\n        newScrollY = ganttFullHeight - ganttHeight;\r\n      }\r\n      setScrollY(newScrollY);\r\n    }\r\n    setIgnoreScrollEvent(true);\r\n  };\r\n\r\n  /**\r\n   * Task select event\r\n   */\r\n  const handleSelectedTask = (taskId: string) => {\r\n    const newSelectedTask = barTasks.find(t => t.id === taskId);\r\n    const oldSelectedTask = barTasks.find(\r\n      t => !!selectedTask && t.id === selectedTask.id\r\n    );\r\n    if (onSelect) {\r\n      if (oldSelectedTask) {\r\n        onSelect(oldSelectedTask, false);\r\n      }\r\n      if (newSelectedTask) {\r\n        onSelect(newSelectedTask, true);\r\n      }\r\n    }\r\n    setSelectedTask(newSelectedTask);\r\n  };\r\n  const handleExpanderClick = (task: Task) => {\r\n    if (onExpanderClick && task.hideChildren !== undefined) {\r\n      onExpanderClick({ ...task, hideChildren: !task.hideChildren });\r\n    }\r\n  };\r\n  const gridProps: GridProps = {\r\n    columnWidth,\r\n    svgWidth,\r\n    tasks: tasks,\r\n    rowHeight,\r\n    dates: dateSetup.dates,\r\n    todayColor,\r\n    rtl,\r\n  };\r\n  const calendarProps: CalendarProps = {\r\n    dateSetup,\r\n    locale,\r\n    viewMode,\r\n    headerHeight,\r\n    columnWidth,\r\n    fontFamily,\r\n    fontSize,\r\n    rtl,\r\n  };\r\n  const barProps: TaskGanttContentProps = {\r\n    tasks: barTasks,\r\n    dates: dateSetup.dates,\r\n    ganttEvent,\r\n    ganttRelationEvent,\r\n    selectedTask,\r\n    rowHeight,\r\n    taskHeight,\r\n    taskHalfHeight,\r\n    relationCircleOffset,\r\n    relationCircleRadius,\r\n    columnWidth,\r\n    arrowColor,\r\n    timeStep,\r\n    fontFamily,\r\n    fontSize,\r\n    arrowIndent,\r\n    svgWidth,\r\n    rtl,\r\n    setGanttEvent,\r\n    setGanttRelationEvent,\r\n    setFailedTask,\r\n    setSelectedTask: handleSelectedTask,\r\n    onDateChange,\r\n    onRelationChange,\r\n    onProgressChange,\r\n    onDoubleClick,\r\n    onClick,\r\n    onDelete,\r\n  };\r\n\r\n  const tableProps: TaskListProps = {\r\n    rowHeight,\r\n    rowWidth: listCellWidth,\r\n    fontFamily,\r\n    fontSize,\r\n    tasks: barTasks,\r\n    locale,\r\n    headerHeight,\r\n    scrollY,\r\n    ganttHeight,\r\n    horizontalContainerClass: styles.horizontalContainer,\r\n    selectedTask,\r\n    taskListRef,\r\n    setSelectedTask: handleSelectedTask,\r\n    onExpanderClick: handleExpanderClick,\r\n    TaskListHeader,\r\n    TaskListTable,\r\n  };\r\n  return (\r\n    <div>\r\n      <div\r\n        className={styles.wrapper}\r\n        onKeyDown={handleKeyDown}\r\n        tabIndex={0}\r\n        ref={wrapperRef}\r\n      >\r\n        {listCellWidth && <TaskList {...tableProps} />}\r\n        <TaskGantt\r\n          gridProps={gridProps}\r\n          calendarProps={calendarProps}\r\n          barProps={barProps}\r\n          ganttHeight={ganttHeight}\r\n          scrollY={scrollY}\r\n          scrollX={scrollX}\r\n        />\r\n        {/* {ganttEvent.changedTask && (\r\n          <Tooltip\r\n            arrowIndent={arrowIndent}\r\n            rowHeight={rowHeight}\r\n            svgContainerHeight={svgContainerHeight}\r\n            svgContainerWidth={svgContainerWidth}\r\n            fontFamily={fontFamily}\r\n            fontSize={fontSize}\r\n            scrollX={scrollX}\r\n            scrollY={scrollY}\r\n            task={ganttEvent.changedTask}\r\n            headerHeight={300}\r\n            taskListWidth={taskListWidth}\r\n            TooltipContent={TooltipContent}\r\n            rtl={rtl}\r\n            svgWidth={svgWidth}\r\n          />\r\n        )} */}\r\n        <VerticalScroll\r\n          ganttFullHeight={ganttFullHeight}\r\n          ganttHeight={ganttHeight}\r\n          headerHeight={headerHeight}\r\n          scroll={scrollY}\r\n          onScroll={handleScrollY}\r\n          rtl={rtl}\r\n        />\r\n      </div>\r\n      {/* <HorizontalScroll\r\n        svgWidth={svgWidth}\r\n        taskListWidth={taskListWidth}\r\n        scroll={scrollX}\r\n        rtl={rtl}\r\n        onScroll={handleScrollX}\r\n      /> */}\r\n    </div>\r\n  );\r\n};\r\n"],"names":["ViewMode","intlDTCache","getCachedDateTimeFormat","locString","opts","key","JSON","stringify","dtf","Intl","DateTimeFormat","addToDate","date","quantity","scale","newDate","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","startOfDate","scores","shouldReset","_scale","maxScore","indexOf","ganttDateRange","tasks","viewMode","preStepsCount","newStartDate","start","newEndDate","task","end","Year","Month","Week","getMonday","Day","QuarterDay","HalfDay","Hour","seedDates","startDate","endDate","currentDate","dates","push","getLocaleMonth","locale","bottomValue","month","format","replace","toLocaleUpperCase","getLocalDayOfWeek","weekday","day","getDay","diff","setDate","getWeekNumberISO8601","tmpDate","valueOf","dayNumber","firstThursday","setMonth","weekNumber","Math","ceil","toString","length","getDaysInMonth","year","TaskListHeaderDefault","headerHeight","fontFamily","fontSize","rowWidth","React","className","styles","ganttTable","style","ganttTable_Header","height","ganttTable_HeaderItem","minWidth","ganttTable_HeaderSeparator","marginTop","textAlign","chipColors","blue","text","background","yellow","green","red","purple","brown","rose","kaki","orange","useProvideChipColors","resolveChipColor","badgeColor","badgeTitle","undefined","resolveChipLabelColor","localeDateStringCache","toLocaleDateStringFactory","dateTimeOptions","lds","toLocaleDateString","formatDate","inputDate","dateObject","TaskListTableDefault","rowHeight","onExpanderClick","useMemo","taskListWrapper","map","t","expanderSymbol","hideChildren","ExpandMoreIcon","ChevronRightIcon","taskListTableRow","id","taskListCell","maxWidth","title","name","taskListNameWrapper","taskListExpander","taskListEmptyExpander","onClick","type","margin","color","padding","borderRadius","fontWeight","maxHeight","lineHeight","whiteSpace","overflow","textOverflow","width","split","join","VerticalScroll","scroll","ganttHeight","ganttFullHeight","rtl","onScroll","scrollRef","useRef","useEffect","current","scrollTop","marginLeft","ref","TaskList","scrollY","selectedTask","setSelectedTask","taskListRef","horizontalContainerClass","TaskListHeader","TaskListTable","horizontalContainerRef","headerProps","selectedTaskId","tableProps","GridBody","svgWidth","columnWidth","todayColor","y","gridRows","rowLines","x","y1","x2","y2","gridRowLine","gridRow","now","tickX","ticks","today","i","getTime","x1","gridTick","fill","Grid","props","TopPartOfCalendar","value","x1Line","y1Line","y2Line","xText","yText","calendarTopTick","calendarTopText","Calendar","dateSetup","getCalendarValuesForYear","topValues","bottomValues","topDefaultHeight","calendarBottomText","topValue","getWeekNumber","d","UTC","setUTCDate","getUTCDate","getUTCDay","yearStart","getUTCFullYear","weekNo","getCalendarValuesForMonth","getCalendarValuesForWeek","weeksCount","getCalendarValuesForDay","middleValues","middleValue","calendarMiddleText","toUpperCase","getCalendarValuesForPartOfDay","hour","getCalendarValuesForHour","displayDate","topPosition","calendarHeader","Arrow","taskFrom","taskTo","taskHeight","arrowIndent","path","trianglePoints","drownPathAndTriangleRTL","drownPathAndTriangle","strokeWidth","points","indexCompare","index","taskToEndPosition","taskFromEndPosition","taskFromHorizontalOffsetValue","taskToHorizontalOffsetValue","RelationLine","relationLine","getRelationCircleByCoordinates","svgP","taskHalfHeight","relationCircleOffset","relationCircleRadius","l","convertToBarTasks","barCornerRadius","handleWidth","barProgressColor","barProgressSelectedColor","barBackgroundColor","barBackgroundSelectedColor","projectProgressColor","projectProgressSelectedColor","projectBackgroundColor","projectBackgroundSelectedColor","milestoneBackgroundColor","milestoneBackgroundSelectedColor","barTasks","convertToBarTask","console","log","dependencies","j","dependence","findIndex","barChildren","offset","barTask","convertToMilestone","convertToBar","taskXCoordinateRTL","taskXCoordinate","typeInternal","progressWithByParams","progress","progressWidth","progressX","taskYCoordinate","backgroundColor","backgroundSelectedColor","progressColor","progressSelectedColor","rotatedHeight","xDate","remainderMillis","percentOfInterval","taskX1","taskX2","progressByX","barWidth","progressPercent","round","progressByXRTL","getProgressPoint","taskY","point","startByX","xStep","steps","additionalXValue","newX","endByX","moveByX","prevTask","newX1","newX2","moveByXForEach","newMoveX1","taskOffset","selectedTaskOffset","newTaskOffset","newX1Test","newX2Test","dateByX","taskX","taskDate","timeStep","getTimezoneOffset","handleTaskBySVGMouseEvent","svgX","action","initEventX1Delta","result","handleTaskBySVGMouseEventForMilestone","handleTaskBySVGMouseEventForBar","changedTasks","changedTask","isChanged","prevDependentTask","filter","item","includes","pop","newMoveX2","childrenIds","getAllBarChildrenIds","prevTaskIndex","obj","ids","child","concat","isKeyboardEvent","event","removeHiddenTasks","groupedTasks","groupedTask","children","getChildren","taskList","project","taskChildren","forEach","sortTasks","taskA","taskB","orderA","displayOrder","Number","MAX_VALUE","orderB","BarDisplay","isSelected","onMouseDown","ry","rx","barBackground","BarDateHandle","barHandle","BarRelationHandle","radius","isRelationDrawMode","cx","cy","r","barRelationHandle","barRelationHandle_drawMode","BarProgressHandle","progressPoint","HtmlTooltip","styled","Tooltip","classes","popper","tooltipClasses","tooltip","boxShadow","Bar","isProgressChangeable","isDateChangeable","isRelationChangeable","onEventStart","onRelationStart","onLeftRelationTriggerMouseDown","useCallback","onRightRelationTriggerMouseDown","handleHeight","taskStyle","placement","followCursor","Fragment","Typography","tooltipDefaultContainerParagraph","barWrapper","stylesRelationHandle","barRelationHandleWrapper","tabIndex","e","Milestone","transform","getBarColor","milestoneWrapper","milestoneBackground","Project","projectWith","projectWrapper","projectBackground","TaskItem","isDelete","textRef","useState","taskItem","setTaskItem","isTextInside","setIsTextInside","getBBox","getX","hasChild","onKeyDown","stopPropagation","onMouseEnter","onMouseLeave","onDoubleClick","onFocus","barLabel","barLabelOutside","TaskGanttContent","ganttEvent","ganttRelationEvent","svg","arrowColor","setGanttEvent","setGanttRelationEvent","setFailedTask","onDateChange","onRelationChange","onProgressChange","onDelete","createSVGPoint","setXStep","setInitEventX1Delta","isMoving","setIsMoving","dateDelta","newXStep","handleMouseMove","preventDefault","clientX","cursor","matrixTransform","getScreenCTM","inverse","handleMouseUp","operationSuccess","originalSelectedTask","newChangedTask","isNotLikeOriginal","prevEnd","removeEventListener","addEventListener","startRelationTarget","target","startRelationTask","svgNode","clientY","ctm","prevValue","endX","endY","endTargetRelationCircle","handleBarEventStart","error","handleBarRelationStart","startX","startY","stroke","Boolean","isDisabled","TaskGantt","gridProps","calendarProps","barProps","scrollX","ganttSVGRef","verticalGanttContainerRef","newBarProps","scrollLeft","ganttVerticalContainerChanged","dir","xmlns","horizontalContainer","Gantt","listCellWidth","barFill","viewDate","onSelect","wrapperRef","setDateSetup","currentViewDate","setCurrentViewDate","setBarTasks","failedTask","setScrollY","setScrollX","ignoreScrollEvent","setIgnoreScrollEvent","filteredTasks","sort","newDates","reverse","prevStateTask","find","mergedArray","changedItem","newTaskList","handleWheel","shiftKey","deltaX","scrollMove","deltaY","newScrollX","newScrollY","passive","handleScrollY","currentTarget","handleKeyDown","isX","handleSelectedTask","taskId","newSelectedTask","oldSelectedTask","handleExpanderClick","wrapper"],"mappings":"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"}